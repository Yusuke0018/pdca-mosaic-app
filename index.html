<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PDCA Mosaic - „ÅÇ„Å™„Åü„ÅÆ‰∫∫Áîü„Çí„Éá„Ç∂„Ç§„É≥„Åô„Çã</title>

    <!-- ‚ñº‚ñº‚ñº „Éõ„Éº„É†ÁîªÈù¢„Ç¢„Ç§„Ç≥„É≥„Å®PWAË®≠ÂÆö ‚ñº‚ñº‚ñº -->
    <meta name="application-name" content="PDCA Mosaic">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PDCA Mosaic">
    <meta name="theme-color" content="#6366f1">

    <!-- „Ç¢„Ç§„Ç≥„É≥„ÅÆÂÆöÁæ© (SVG„ÇíÁõ¥Êé•Âüã„ÇÅËæº„Åø) -->
    <link rel="icon" href="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3cdefs%3e%3clinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3e%3cstop offset='0%25' style='stop-color:%236366f1;stop-opacity:1' /%3e%3cstop offset='100%25' style='stop-color:%23f59e0b;stop-opacity:1' /%3e%3c/linearGradient%3e%3cfilter id='shadow' x='-20%25' y='-20%25' width='140%25' height='140%25'%3e%3cfeGaussianBlur in='SourceAlpha' stdDeviation='2'/%3e%3cfeOffset dx='2' dy='2' result='offsetblur'/%3e%3cfeComponentTransfer%3e%3cfeFuncA type='linear' slope='0.5'/%3e%3c/feComponentTransfer%3e%3cfeMerge%3e%3cfeMergeNode/%3e%3cfeMergeNode in='SourceGraphic'/%3e%3c/feMerge%3e%3c/filter%3e%3c/defs%3e%3crect width='100' height='100' rx='20' fill='url(%23grad)' /%3e%3ctext x='50' y='68' font-family='sans-serif' font-size='60' font-weight='bold' fill='white' text-anchor='middle' filter='url(%23shadow)'%3e‚óà%3c/text%3e%3c/svg%3e">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3cdefs%3e%3clinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3e%3cstop offset='0%25' style='stop-color:%236366f1;stop-opacity:1' /%3e%3cstop offset='100%25' style='stop-color:%23f59e0b;stop-opacity:1' /%3e%3c/linearGradient%3e%3cfilter id='shadow' x='-20%25' y='-20%25' width='140%25' height='140%25'%3e%3cfeGaussianBlur in='SourceAlpha' stdDeviation='2'/%3e%3cfeOffset dx='2' dy='2' result='offsetblur'/%3e%3cfeComponentTransfer%3e%3cfeFuncA type='linear' slope='0.5'/%3e%3c/feComponentTransfer%3e%3cfeMerge%3e%3cfeMergeNode/%3e%3cfeMergeNode in='SourceGraphic'/%3e%3c/feMerge%3e%3c/filter%3e%3c/defs%3e%3crect width='100' height='100' rx='20' fill='url(%23grad)' /%3e%3ctext x='50' y='68' font-family='sans-serif' font-size='60' font-weight='bold' fill='white' text-anchor='middle' filter='url(%23shadow)'%3e‚óà%3c/text%3e%3c/svg%3e">

    <!-- Web App Manifest (JSON„ÇíÁõ¥Êé•Âüã„ÇÅËæº„Åø) -->
    <link rel="manifest" href="data:application/manifest+json,{&quot;name&quot;:&quot;PDCA Mosaic - „ÅÇ„Å™„Åü„ÅÆ‰∫∫Áîü„Çí„Éá„Ç∂„Ç§„É≥„Åô„Çã&quot;,&quot;short_name&quot;:&quot;PDCA Mosaic&quot;,&quot;start_url&quot;:&quot;.&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;#f3f4f6&quot;,&quot;theme_color&quot;:&quot;#6366f1&quot;,&quot;description&quot;:&quot;„ÅÇ„Å™„Åü„ÅÆPDCA„Çµ„Ç§„ÇØ„É´„ÇíÁÆ°ÁêÜ„Åó„ÄÅ‰∫∫Áîü„Çí„Éá„Ç∂„Ç§„É≥„Åô„Çã„Åü„ÇÅ„ÅÆ„Ç¶„Çß„Éñ„Ç¢„Éó„É™„Åß„Åô„ÄÇ&quot;,&quot;icons&quot;:[{&quot;src&quot;:&quot;data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3cdefs%3e%3clinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3e%3cstop offset='0%25' style='stop-color:%236366f1;stop-opacity:1' /%3e%3cstop offset='100%25' style='stop-color:%23f59e0b;stop-opacity:1' /%3e%3c/linearGradient%3e%3cfilter id='shadow' x='-20%25' y='-20%25' width='140%25' height='140%25'%3e%3cfeGaussianBlur in='SourceAlpha' stdDeviation='2'/%3e%3cfeOffset dx='2' dy='2' result='offsetblur'/%3e%3cfeComponentTransfer%3e%3cfeFuncA type='linear' slope='0.5'/%3e%3c/feComponentTransfer%3e%3cfeMerge%3e %3cfeMergeNode/%3e%3cfeMergeNode in='SourceGraphic'/%3e %3c/feMerge%3e%3c/filter%3e%3c/defs%3e%3crect width='100' height='100' rx='20' fill='url(%23grad)' /%3e%3ctext x='50' y='68' font-family='sans-serif' font-size='60' font-weight='bold' fill='white' text-anchor='middle' filter='url(%23shadow)'%3e‚óà%3c/text%3e%3c/svg%3e&quot;,&quot;sizes&quot;:&quot;192x192&quot;,&quot;type&quot;:&quot;image/svg+xml&quot;,&quot;purpose&quot;:&quot;any maskable&quot;},{&quot;src&quot;:&quot;data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3cdefs%3e%3clinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3e%3cstop offset='0%25' style='stop-color:%236366f1;stop-opacity:1' /%3e%3cstop offset='100%25' style='stop-color:%23f59e0b;stop-opacity:1' /%3e%3c/linearGradient%3e%3cfilter id='shadow' x='-20%25' y='-20%25' width='140%25' height='140%25'%3e%3cfeGaussianBlur in='SourceAlpha' stdDeviation='2'/%3e%3cfeOffset dx='2' dy='2' result='offsetblur'/%3e%3cfeComponentTransfer%3e%3cfeFuncA type='linear' slope='0.5'/%3e%3c/feComponentTransfer%3e%3cfeMerge%3e %3cfeMergeNode/%3e%3cfeMergeNode in='SourceGraphic'/%3e %3c/feMerge%3e%3c/filter%3e%3c/defs%3e%3crect width='100' height='100' rx='20' fill='url(%23grad)' /%3e%3ctext x='50' y='68' font-family='sans-serif' font-size='60' font-weight='bold' fill='white' text-anchor='middle' filter='url(%23shadow)'%3e‚óà%3c/text%3e%3c/svg%3e&quot;,&quot;sizes&quot;:&quot;512x512&quot;,&quot;type&quot;:&quot;image/svg+xml&quot;,&quot;purpose&quot;:&quot;any maskable&quot;}]}">
    <!-- ‚ñ≤‚ñ≤‚ñ≤ „Éõ„Éº„É†ÁîªÈù¢„Ç¢„Ç§„Ç≥„É≥„Å®PWAË®≠ÂÆö ‚ñ≤‚ñ≤‚ñ≤ -->

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1f2937;
            --gray: #6b7280;
            --light-gray: #f3f4f6;
            --white: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --radius: 16px;
            --radius-lg: 24px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light-gray);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            z-index: 200;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.2rem;
        }

        /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
        .nav-tabs {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--white);
            padding: 0.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 60px;
            z-index: 100;
        }
        
        .nav-primary {
            display: flex;
            gap: 0.5rem;
            flex: 1;
        }
        
        .nav-secondary {
            position: relative;
        }

        .nav-tab {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: transparent;
            border: 2px solid transparent;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .nav-tab:hover {
            background: var(--light-gray);
            transform: translateY(-1px);
        }
        
        .nav-icon {
            font-size: 1.2rem;
        }
        
        .nav-text {
            display: none;
        }
        
        @media (min-width: 768px) {
            .nav-text {
                display: inline;
            }
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--white);
            border-color: var(--primary);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }
        
        .nav-menu-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            background: var(--light-gray);
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }
        
        .nav-menu-btn:hover {
            background: var(--primary);
            color: var(--white);
            transform: rotate(90deg);
        }
        
        .nav-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: var(--white);
            border-radius: var(--radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .nav-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text);
            font-size: 0.95rem;
        }
        
        .dropdown-item:hover {
            background: var(--light-gray);
            padding-left: 1.25rem;
        }
        
        .dropdown-item:first-child {
            border-radius: var(--radius) var(--radius) 0 0;
        }
        
        .dropdown-item:last-child {
            border-radius: 0 0 var(--radius) var(--radius);
        }
        
        .dropdown-icon {
            font-size: 1.1rem;
        }
        
        .dropdown-divider {
            height: 1px;
            background: var(--border);
            margin: 0.5rem 0;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ */
        .main-content {
            padding: 1rem;
            padding-bottom: 100px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* „Çª„ÇØ„Ç∑„Éß„É≥ */
        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        /* Ê§úÁ¥¢„Éê„Éº */
        .search-container {
            background: var(--white);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
        }

        .search-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--light-gray);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .filter-tags {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-tag {
            padding: 0.5rem 1rem;
            background: var(--light-gray);
            border: none;
            border-radius: 999px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-tag.active {
            background: var(--primary);
            color: var(--white);
        }

        /* „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Ç∞„É™„ÉÉ„Éâ */
        .project-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: 1fr;
        }

        /* „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Ç´„Éº„Éâ */
        .project-card {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid rgba(0,0,0,0.06);
            overflow: hidden;
        }
        
        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .project-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            border-color: var(--primary);
        }
        
        .project-card:hover::before {
            transform: scaleX(1);
        }

        .project-card.completed {
            opacity: 0.8;
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .project-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .project-phase {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: var(--primary);
            color: var(--white);
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .project-stats {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-item {
            flex: 1;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--light-gray);
            border-radius: 999px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 999px;
            transition: width 0.3s ease;
        }

        /* „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„ÉàÈÄ≤Êçó */
        .checkpoint-progress {
            margin-top: 1rem;
            font-size: 0.875rem;
        }

        .checkpoint-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .checkpoint-item:last-child {
            border-bottom: none;
        }

        .checkpoint-name {
            flex: 1;
            color: var(--dark);
        }

        .checkpoint-rate {
            font-weight: 600;
            color: var(--primary);
        }

        .mini-progress {
            width: 60px;
            height: 4px;
            background: var(--light-gray);
            border-radius: 2px;
            overflow: hidden;
            margin-left: 0.5rem;
        }

        .mini-progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
        }

        /* „Ç´„Ç¶„É≥„Çø„Éº */
        .counter-section {
            margin-top: 1rem;
        }

        .counter-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background: var(--light-gray);
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
        }

        .counter-label {
            font-weight: 500;
            color: var(--dark);
        }

        .counter-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .counter-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: var(--white);
            color: var(--dark);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .counter-btn:hover {
            background: var(--primary);
            color: var(--white);
        }

        .counter-value {
            min-width: 60px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--primary);
            cursor: pointer;
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .counter-value:hover {
            background: var(--light-gray);
        }

        .counter-input {
            width: 60px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--primary);
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 0.25rem;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--white);
            border: none;
            border-radius: 50%;
            box-shadow: 0 4px 20px rgba(79, 172, 254, 0.4);
            backdrop-filter: blur(10px);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .fab:hover {
            transform: scale(1.1);
        }

        .fab:active {
            transform: scale(0.95);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--white);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .bottom-nav-content {
            display: flex;
            justify-content: space-around;
            padding: 0.5rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .nav-item {
            background: none;
            border: none;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            color: var(--gray);
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-icon {
            font-size: 1.25rem;
        }

        .nav-label {
            font-size: 0.75rem;
        }

        /* „É¢„Éº„ÉÄ„É´ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            padding: 1rem;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--white);
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--light-gray);
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--light-gray);
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        /* „Éï„Ç©„Éº„É†Ë¶ÅÁ¥† */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--light-gray);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        /* „Éú„Çø„É≥ */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--white);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--light-gray);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-danger {
            background: var(--danger);
            color: var(--white);
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* Á©∫Áä∂ÊÖã */
        .empty-state {
            text-align: center;
            padding: 3rem;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .empty-text {
            color: var(--gray);
            margin-bottom: 1.5rem;
        }

        /* Daily Reminder Banner */
        .reminder-banner {
            position: fixed;
            top: -100px;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: var(--white);
            padding: 1rem;
            text-align: center;
            z-index: 1000;
            transition: top 0.3s ease;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
        }

        .reminder-banner.show {
            top: 0;
            animation: slideDown 0.3s ease;
        }

        .reminder-text {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .reminder-subtext {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        /* Inbox Item */
        .inbox-item {
            background: var(--white);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 0.75rem;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .inbox-item:hover {
            transform: translateX(4px);
        }

        .inbox-content {
            flex: 1;
        }

        .inbox-date {
            font-size: 0.75rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        .inbox-action {
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--white);
            border: none;
            border-radius: var(--radius);
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .inbox-action:hover {
            transform: scale(1.05);
        }

        /* Settings */
        .settings-item {
            padding: 1rem;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-item:hover {
            background: var(--light-gray);
        }

        .settings-label {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .settings-description {
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* Checkbox */
        .checkbox-group {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            background: var(--light-gray);
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-group:hover {
            background: #e5e7eb;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 0.75rem;
            cursor: pointer;
        }

        .checkbox-label {
            flex: 1;
        }

        /* Milestone Item */
        .milestone-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            background: var(--light-gray);
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
        }

        .milestone-checkbox {
            width: 24px;
            height: 24px;
            margin-right: 0.75rem;
        }

        .milestone-text {
            flex: 1;
        }

        .milestone-achieved {
            text-decoration: line-through;
            color: var(--gray);
        }

        /* Phase Actions */
        .phase-actions {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--light-gray);
        }

        .phase-action {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            background: var(--light-gray);
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .phase-action:hover {
            background: #e5e7eb;
        }

        .phase-action-icon {
            margin-right: 0.5rem;
        }

        /* Analysis Card */
        .analysis-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .analysis-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .analysis-content {
            font-size: 0.875rem;
            line-height: 1.6;
        }

        /* „Ç´„Ç¶„É≥„ÉàÈ†ÖÁõÆËøΩÂä† */
        .add-counter-item {
            padding: 0.5rem;
            background: var(--light-gray);
            border-radius: var(--radius);
            margin-top: 0.5rem;
            display: flex;
            gap: 0.5rem;
        }

        .add-counter-input {
            flex: 1;
            padding: 0.5rem;
            border: 2px solid var(--white);
            border-radius: 8px;
            font-size: 0.875rem;
        }

        .add-counter-btn {
            padding: 0.5rem 1rem;
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
            cursor: pointer;
        }

        /* ToastÈÄöÁü• */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--dark);
            color: var(--white);
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 3000;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .toast.success {
            background: var(--success);
        }

        .toast.error {
            background: var(--danger);
        }

        /* „Ç¥„ÉüÁÆ±„Ç¢„Ç§„Ç≥„É≥ */
        .trash-icon {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 32px;
            height: 32px;
            background: var(--danger);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .project-card:hover .trash-icon {
            opacity: 1;
        }

        /* Responsive */
        @media (min-width: 768px) {
            .project-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-content {
                max-width: 600px;
            }
        }

        @media (min-width: 1024px) {
            .project-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes swipeIndicator {
            from { 
                transform: translateY(-50%) scale(0.5); 
                opacity: 0;
            }
            50% {
                transform: translateY(-50%) scale(1);
                opacity: 0.3;
            }
            to { 
                transform: translateY(-50%) scale(0.8); 
                opacity: 0;
            }
        }

        /* ÂÆå‰∫Ü„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂ∞ÇÁî®„Çπ„Çø„Ç§„É´ */
        .completed-badge {
            display: inline-block;
            background: var(--success);
            color: var(--white);
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-left: 0.5rem;
        }

        /* „Ç´„É¨„É≥„ÉÄ„Éº„Çπ„Çø„Ç§„É´ */
        .calendar-container {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 1rem;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .calendar-nav {
            display: flex;
            gap: 0.5rem;
        }

        .calendar-nav-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--light-gray);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .calendar-nav-btn:hover {
            background: var(--primary);
            color: var(--white);
        }

        .calendar-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.25rem;
            margin-top: 1rem;
        }

        .calendar-weekday {
            text-align: center;
            font-size: 0.75rem;
            color: var(--gray);
            padding: 0.5rem;
            font-weight: 600;
        }

        .calendar-day {
            aspect-ratio: 1;
            border: 2px solid transparent;
            border-radius: var(--radius);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            background: var(--white);
            font-weight: 500;
        }

        .calendar-day:hover {
            background: var(--light-gray);
            transform: scale(1.05);
        }

        .calendar-day.other-month {
            color: var(--gray);
            opacity: 0.5;
        }

        .calendar-day.today {
            background: var(--primary);
            color: var(--white);
            font-weight: 700;
        }

        .calendar-day.has-activity {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .calendar-day.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            transform: scale(1.05);
        }

        .calendar-day-number {
            font-size: 0.875rem;
        }

        .calendar-day-indicator {
            position: absolute;
            bottom: 4px;
            display: flex;
            gap: 2px;
        }

        .activity-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--success);
        }

        /* Êó•‰ªòË©≥Á¥∞„Éì„É•„Éº */
        .day-detail {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            animation: slideUp 0.3s ease;
        }

        .day-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light-gray);
        }

        .day-detail-date {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .day-detail-section {
            margin-bottom: 1.5rem;
        }

        .day-detail-section-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .day-detail-item {
            background: var(--light-gray);
            padding: 1rem;
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
        }

        .day-detail-project {
            font-weight: 500;
            color: var(--primary);
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        /* ÁâáÊâãÊìç‰Ωú„ÅÆÊîπÂñÑ */
        @media (max-width: 768px) {
            .main-content {
                padding-bottom: 120px;
            }

            .bottom-nav {
                height: 80px;
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(20px);
            }

            .nav-item {
                padding: 0.75rem 1rem;
            }

            .nav-icon {
                font-size: 1.5rem;
            }

            .nav-label {
                font-size: 0.85rem;
                font-weight: 500;
            }

            .project-card {
                margin-bottom: 1rem;
                padding: 1.25rem;
            }

            .fab {
                bottom: 100px;
                width: 64px;
                height: 64px;
                font-size: 1.75rem;
            }

            /* „Çø„ÉÉ„Éó„Çø„Éº„Ç≤„ÉÉ„Éà„ÇíÂ§ß„Åç„Åè */
            .btn {
                min-height: 48px;
                padding: 0.875rem 1.75rem;
            }

            .counter-btn {
                width: 44px;
                height: 44px;
            }

            .checkbox-group input[type="checkbox"] {
                width: 24px;
                height: 24px;
            }

            /* „Çπ„ÉØ„Ç§„Éó„Éí„É≥„Éà */
            .swipe-hint {
                position: fixed;
                bottom: 90px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.8);
                color: var(--white);
                padding: 0.5rem 1rem;
                border-radius: 999px;
                font-size: 0.75rem;
                opacity: 0;
                transition: opacity 0.3s ease;
                pointer-events: none;
                z-index: 1000;
            }

            .swipe-hint.show {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div id="toast" class="toast"></div>

    <!-- Daily Reminder Banner -->
    <div id="reminderBanner" class="reminder-banner" onclick="showDailyLog()">
        <div class="reminder-text">üîî ‰ªäÊó•„ÅÆ„Çø„Çπ„ÇØ„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åó„Çá„ÅÜÔºÅ</div>
        <div class="reminder-subtext">„Çø„ÉÉ„Éó„Åó„Å¶Ë®òÈå≤„ÇíÈñãÂßã</div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">‚óà</div>
                <span>PDCA Mosaic</span>
            </div>
            <button class="nav-item" onclick="showSettings()">
                <span class="nav-icon">‚öôÔ∏è</span>
            </button>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="nav-tabs">
        <div class="nav-primary">
            <button class="nav-tab active" onclick="showSection('dashboard')">
                <span class="nav-icon">üìä</span>
                <span class="nav-text">„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</span>
            </button>
            <button class="nav-tab" onclick="showSection('play')">
                <span class="nav-icon">üí°</span>
                <span class="nav-text">„Ç¢„Ç§„Éá„Ç¢</span>
            </button>
            <button class="nav-tab" onclick="showSection('daily')">
                <span class="nav-icon">üí¨</span>
                <span class="nav-text">„Éá„Ç§„É™„Éº</span>
            </button>
            <button class="nav-tab" onclick="showSection('calendar')">
                <span class="nav-icon">üìÖ</span>
                <span class="nav-text">„Ç´„É¨„É≥„ÉÄ„Éº</span>
            </button>
        </div>
        <div class="nav-secondary">
            <button class="nav-menu-btn" onclick="toggleNavMenu()">
                <span class="menu-icon">‚ãØ</span>
            </button>
            <div class="nav-dropdown">
                <button class="dropdown-item" onclick="showSection('weekly')">
                    <span class="dropdown-icon">üìà</span>ÈÄ±Ê¨°„É¨„Éù„Éº„Éà
                </button>
                <button class="dropdown-item" onclick="showSection('monthly')">
                    <span class="dropdown-icon">üìä</span>ÊúàÊ¨°„Ç§„É≥„Çµ„Ç§„Éà
                </button>
                <button class="dropdown-item" onclick="showSection('quarterly')">
                    <span class="dropdown-icon">üéØ</span>3„É∂Êúà„Ç§„É≥„Çµ„Ç§„Éà
                </button>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item" onclick="showSection('completed')">
                    <span class="dropdown-icon">‚úÖ</span>ÂÆå‰∫ÜÊ∏à„Åø
                </button>
                <button class="dropdown-item" onclick="showSection('trash')">
                    <span class="dropdown-icon">üóëÔ∏è</span>„Ç¥„ÉüÁÆ±
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <!-- Search and Filter -->
            <div class="search-container">
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÊ§úÁ¥¢..."
                       onkeyup="filterProjects()">
                <div class="filter-tags">
                    <button class="filter-tag active" onclick="setFilter('all')">„Åô„Åπ„Å¶</button>
                    <button class="filter-tag" onclick="setFilter('Design')">Design</button>
                    <button class="filter-tag" onclick="setFilter('Check')">Check</button>
                    <button class="filter-tag" onclick="setFilter('Adapt')">Adapt</button>
                </div>
            </div>

            <div class="project-grid" id="projectGrid">
                <!-- Projects will be dynamically loaded here -->
            </div>
            
            <div class="empty-state" id="emptyState" style="display: none;">
                <div class="empty-icon">üìã</div>
                <div class="empty-text">„Åæ„Å†„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                <button class="btn btn-primary" onclick="showSection('play')">„Ç¢„Ç§„Éá„Ç¢‰∏ÄË¶ß„Å∏</button>
            </div>
        </section>

        <!-- Play (Ideas) Section -->
        <section id="play" class="section">
            <h2 style="margin-bottom: 1rem;">„Ç¢„Ç§„Éá„Ç¢„Éª„Ç§„É≥„Éú„ÉÉ„ÇØ„Çπ</h2>
            <div id="inboxList">
                <!-- Ideas will be listed here -->
            </div>
            <div class="empty-state" id="inboxEmpty" style="display: none;">
                <div class="empty-icon">üí°</div>
                <div class="empty-text">Êñ∞„Åó„ÅÑ„Ç¢„Ç§„Éá„Ç¢„ÇíËøΩÂä†„Åó„Åæ„Åó„Çá„ÅÜ</div>
            </div>
        </section>

        <!-- Completed Projects Section -->
        <section id="completed" class="section">
            <h2 style="margin-bottom: 1rem;">ÂÆå‰∫Ü„Åó„Åü„Éó„É≠„Ç∏„Çß„ÇØ„Éà</h2>
            <div class="project-grid" id="completedGrid">
                <!-- Completed projects will be listed here -->
            </div>
            <div class="empty-state" id="completedEmpty" style="display: none;">
                <div class="empty-icon">‚úÖ</div>
                <div class="empty-text">„Åæ„Å†ÂÆå‰∫Ü„Åó„Åü„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
            </div>
        </section>

        <!-- Trash Section -->
        <section id="trash" class="section">
            <h2 style="margin-bottom: 1rem;">„Ç¥„ÉüÁÆ±</h2>
            <div class="project-grid" id="trashGrid">
                <!-- Deleted projects will be listed here -->
            </div>
            <div class="empty-state" id="trashEmpty" style="display: none;">
                <div class="empty-icon">üóëÔ∏è</div>
                <div class="empty-text">„Ç¥„ÉüÁÆ±„ÅØÁ©∫„Åß„Åô</div>
            </div>
            <button class="btn btn-danger" onclick="emptyTrash()" style="margin-top: 1rem;">
                „Ç¥„ÉüÁÆ±„ÇíÁ©∫„Å´„Åô„Çã
            </button>
        </section>

        <!-- Weekly Report Section -->
        <section id="weekly" class="section">
            <h2 style="margin-bottom: 1rem;">ÈÄ±Ê¨°„Ç§„É≥„Çµ„Ç§„Éà</h2>
            <div id="weeklyReport">
                <div class="empty-state">
                    <div class="empty-icon">üìä</div>
                    <div class="empty-text">„É¨„Éù„Éº„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                    <button class="btn btn-primary" onclick="generateWeeklyReport()">„É¨„Éù„Éº„Éà„ÇíÁîüÊàê</button>
                </div>
            </div>
        </section>

        <!-- Daily Comment Section -->
        <section id="daily" class="section">
            <h2 style="margin-bottom: 1rem;">„Éá„Ç§„É™„Éº„Ç≥„É°„É≥„Éà</h2>
            <div id="dailyComment">
                <div class="empty-state">
                    <div class="empty-icon">üí¨</div>
                    <div class="empty-text">‰ªäÊó•„ÅÆ„Ç≥„É°„É≥„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                    <button class="btn btn-primary" onclick="generateDailyComment()">‰ªäÊó•„ÅÆ„Ç≥„É°„É≥„Éà„ÇíÁîüÊàê</button>
                </div>
            </div>
        </section>

        <!-- Monthly Insights Section -->
        <section id="monthly" class="section">
            <h2 style="margin-bottom: 1rem;">ÊúàÊ¨°„Ç§„É≥„Çµ„Ç§„Éà</h2>
            <div id="monthlyInsight">
                <div class="empty-state">
                    <div class="empty-icon">üìà</div>
                    <div class="empty-text">‰ªäÊúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                    <button class="btn btn-primary" onclick="generateMonthlyInsight()">‰ªäÊúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê</button>
                </div>
            </div>
        </section>

        <!-- Quarterly Insights Section -->
        <section id="quarterly" class="section">
            <h2 style="margin-bottom: 1rem;">3„É∂Êúà„Ç§„É≥„Çµ„Ç§„Éà</h2>
            <div id="quarterlyInsight">
                <div class="empty-state">
                    <div class="empty-icon">üéØ</div>
                    <div class="empty-text">3„É∂Êúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                    <button class="btn btn-primary" onclick="generateQuarterlyInsight()">3„É∂Êúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê</button>
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="calendar" class="section">
            <div class="calendar-container">
                <div class="calendar-header">
                    <button class="calendar-nav-btn" onclick="changeMonth(-1)">‚óÄ</button>
                    <div class="calendar-title" id="calendarTitle">2024Âπ¥1Êúà</div>
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" onclick="changeMonth(1)">‚ñ∂</button>
                        <button class="calendar-nav-btn" onclick="goToToday()">‰ªäÊó•</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar will be rendered here -->
                </div>
            </div>
            <div id="dayDetail" style="display: none;">
                <!-- Day detail will be shown here -->
            </div>
        </section>
    </main>

    <!-- Floating Action Button -->
    <button class="fab" onclick="showAddModal()">+</button>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="bottom-nav-content">
            <button class="nav-item active" onclick="showSection('dashboard')">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">„Éõ„Éº„É†</span>
            </button>
            <button class="nav-item" onclick="showSection('play')">
                <span class="nav-icon">üí°</span>
                <span class="nav-label">„Ç¢„Ç§„Éá„Ç¢</span>
            </button>
            <button class="nav-item" onclick="showDailyLog()">
                <span class="nav-icon">üìù</span>
                <span class="nav-label">Ë®òÈå≤</span>
            </button>
            <button class="nav-item" onclick="showSection('calendar')">
                <span class="nav-icon">üìÖ</span>
                <span class="nav-label">„Ç´„É¨„É≥„ÉÄ„Éº</span>
            </button>
        </div>
    </nav>

    <!-- Add Idea Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Êñ∞„Åó„ÅÑ„Ç¢„Ç§„Éá„Ç¢</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">„Å©„Çì„Å™„Ç¢„Ç§„Éá„Ç¢Ôºü</label>
                    <textarea class="form-control" id="ideaContent" placeholder="‰æã: „Éê„Éº„Éî„Éº„ÇíÊØéÊó•„ÇÑ„Å£„Å¶„Åø„Çã"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addModal')">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn btn-primary" onclick="addIdea()">ËøΩÂä†</button>
            </div>
        </div>
    </div>

    <!-- Project Design Modal -->
    <div class="modal" id="designModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">„Éó„É≠„Ç∏„Çß„ÇØ„ÉàË®≠Ë®à</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂêç</label>
                    <input type="text" class="form-control" id="projectName" placeholder="‰æã: „Éê„Éº„Éî„ÉºÁøíÊÖ£Âåñ„Éó„É≠„Ç∏„Çß„ÇØ„Éà">
                </div>
                
                <div class="form-group">
                    <label class="form-label">„Ç¥„Éº„É´Ôºà‰Ωï„ÇíÈÅîÊàê„Åó„Åü„ÅÑÔºüÔºâ</label>
                    <textarea class="form-control" id="projectGoal" placeholder="‰æã: 3„É∂ÊúàÂæå„Å´„ÄÅÊØéÊó•20Âõû„ÅÆ„Éê„Éº„Éî„Éº„ÇíÊÅØÂàá„Çå„Åõ„Åö„Å´„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çã"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÊúüÈñì</label>
                    <select class="form-control" id="projectDuration">
                        <option value="7">1ÈÄ±Èñì</option>
                        <option value="14">2ÈÄ±Èñì</option>
                        <option value="30" selected>30Êó•Èñì</option>
                        <option value="60">60Êó•Èñì</option>
                        <option value="90">90Êó•Èñì</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÈÄ≤ÊçóÁÆ°ÁêÜÊñπÊ≥ï</label>
                    <select class="form-control" id="trackingType" onchange="updateTrackingUI()">
                        <option value="daily">ÊØéÊó•„ÉÅ„Çß„ÉÉ„ÇØ</option>
                        <option value="count">ÂõûÊï∞„Çí„Ç´„Ç¶„É≥„Éà</option>
                        <option value="milestone">„Éû„Ç§„É´„Çπ„Éà„Éº„É≥ÈÅîÊàê</option>
                    </select>
                </div>
                
                <div class="form-group" id="dailyCheckGroup">
                    <label class="form-label">ÊØéÊó•„ÉÅ„Çß„ÉÉ„ÇØ„Åô„ÇãÈ†ÖÁõÆ</label>
                    <div id="checkpoints">
                        <input type="text" class="form-control" style="margin-bottom: 0.5rem;" placeholder="‰æã: „Éê„Éº„Éî„Éº„Çí10ÂõûÂÆüÊñΩ">
                    </div>
                    <button class="btn btn-secondary" style="margin-top: 0.5rem;" onclick="addCheckpoint()">+ È†ÖÁõÆ„ÇíËøΩÂä†</button>
                </div>
                
                <div class="form-group" id="countGroup" style="display: none;">
                    <label class="form-label">„Ç´„Ç¶„É≥„Éà„Åô„ÇãÈ†ÖÁõÆ</label>
                    <div id="countItems">
                        <input type="text" class="form-control" style="margin-bottom: 0.5rem;" placeholder="‰æã: „Éê„Éº„Éî„Éº„ÅÆÂõûÊï∞">
                    </div>
                    <button class="btn btn-secondary" style="margin-top: 0.5rem;" onclick="addCountItem()">+ È†ÖÁõÆ„ÇíËøΩÂä†</button>
                </div>
                
                <div class="form-group" id="milestoneGroup" style="display: none;">
                    <label class="form-label">ÈÅîÊàê„Åó„Åü„ÅÑ„Éû„Ç§„É´„Çπ„Éà„Éº„É≥</label>
                    <div id="milestones">
                        <input type="text" class="form-control" style="margin-bottom: 0.5rem;" placeholder="‰æã: 10ÂõûÈÄ£Á∂ö„Åß„Éê„Éº„Éî„Éº„Åå„Åß„Åç„Çã">
                    </div>
                    <button class="btn btn-secondary" style="margin-top: 0.5rem;" onclick="addMilestone()">+ „Éû„Ç§„É´„Çπ„Éà„Éº„É≥„ÇíËøΩÂä†</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('designModal')">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn btn-primary" onclick="createProject()">„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈñãÂßã</button>
            </div>
        </div>
    </div>

    <!-- Daily Log Modal -->
    <div class="modal" id="logModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‰ªäÊó•„ÅÆË®òÈå≤</h3>
            </div>
            <div class="modal-body" id="logModalBody">
                <!-- Daily logs will be loaded here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('logModal')">Èñâ„Åò„Çã</button>
                <button class="btn btn-primary" onclick="saveDailyLog()">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Project Detail Modal -->
    <div class="modal" id="projectModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="projectModalTitle">„Éó„É≠„Ç∏„Çß„ÇØ„ÉàË©≥Á¥∞</h3>
            </div>
            <div class="modal-body" id="projectModalBody">
                <!-- Project details will be loaded here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('projectModal')">Èñâ„Åò„Çã</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Ë®≠ÂÆö</h3>
            </div>
            <div class="modal-body">
                <div class="settings-item" onclick="showAPIKeyModal()">
                    <div class="settings-label">OpenAI API„Ç≠„Éº</div>
                    <div class="settings-description">AIÂàÜÊûêÊ©üËÉΩ„Çí‰ΩøÁî®„Åô„Çã„Åü„ÇÅ„Å´ÂøÖË¶Å„Åß„Åô</div>
                </div>
                
                <div class="settings-item" onclick="exportData()">
                    <div class="settings-label">„Éá„Éº„Çø„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà</div>
                    <div class="settings-description">„Åô„Åπ„Å¶„ÅÆ„Éá„Éº„Çø„ÇíJSON„Éï„Ç°„Ç§„É´„Åß‰øùÂ≠ò</div>
                </div>
                
                <div class="settings-item" onclick="importData()">
                    <div class="settings-label">„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà</div>
                    <div class="settings-description">‰øùÂ≠ò„Åó„Åü„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÇÄ</div>
                </div>
                
                <div class="settings-item" onclick="toggleNotifications()">
                    <div class="settings-label">ÈÄöÁü•Ë®≠ÂÆö</div>
                    <div class="settings-description" id="notificationStatus">ÈÄöÁü•„Çí„Ç™„É≥„Å´„Åô„Çã</div>
                </div>
                
                <input type="file" id="importFile" style="display: none;" accept=".json" onchange="handleImport(event)">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('settingsModal')">Èñâ„Åò„Çã</button>
            </div>
        </div>
    </div>

    <!-- API Key Modal -->
    <div class="modal" id="apiKeyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">OpenAI API„Ç≠„ÉºË®≠ÂÆö</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">API„Ç≠„Éº</label>
                    <input type="password" class="form-control" id="apiKey" placeholder="sk-...">
                    <small style="color: var(--gray); display: block; margin-top: 0.5rem;">
                        API„Ç≠„Éº„ÅØÊöóÂè∑Âåñ„Åó„Å¶„É≠„Éº„Ç´„É´„Å´‰øùÂ≠ò„Åï„Çå„Åæ„Åô
                    </small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('apiKeyModal')">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn btn-primary" onclick="saveAPIKey()">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Improvement Memo Modal -->
    <div class="modal" id="improvementModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ÊîπÂñÑÁÇπ„É°„É¢</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Êñ∞„Åó„ÅÑÊîπÂñÑÁÇπ</label>
                    <textarea class="form-control" id="newImprovement" rows="3" placeholder="ÂÆüÊñΩ„Åó„ÅüÊîπÂñÑ„ÇÑ‰ªäÂæå„ÅÆÊîπÂñÑ„Ç¢„Ç§„Éá„Ç¢„ÇíË®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
                </div>
                <div style="margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="addImprovementMemo()">ËøΩÂä†</button>
                </div>
                <div id="improvementsList" style="margin-top: 2rem;">
                    <!-- ÊîπÂñÑÁÇπ„É™„Çπ„Éà„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('improvementModal')">Èñâ„Åò„Çã</button>
            </div>
        </div>
    </div>

    <script>
        // „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÁä∂ÊÖãÁÆ°ÁêÜ
        const app = {
            ideas: [],
            projects: [],
            logs: [],
            improvements: [],
            currentSection: 'dashboard',
            currentProjectId: null,
            apiKey: null,
            searchQuery: '',
            filterPhase: 'all'
        };

        // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„ÅÆ„Ç≠„Éº
        const STORAGE_KEYS = {
            IDEAS: 'pdca_ideas',
            PROJECTS: 'pdca_projects',
            LOGS: 'pdca_logs',
            IMPROVEMENTS: 'pdca_improvements',
            API_KEY: 'pdca_api_key',
            LAST_CHECK_DATE: 'pdca_last_check',
            NOTIFICATION_SETTINGS: 'pdca_notifications'
        };

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderDashboard();
            setupEventListeners();
            checkDailyReminder();
            requestNotificationPermission();
            // Ë§áÊï∞„Çø„ÉñÂêåÊúü
            window.addEventListener('storage', handleStorageChange);
        });

        // „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„É°„Éã„É•„Éº„ÅÆÂàá„ÇäÊõø„Åà
        function toggleNavMenu() {
            const dropdown = document.querySelector('.nav-dropdown');
            dropdown.classList.toggle('active');
            
            // Â§ñÂÅ¥„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
            if (dropdown.classList.contains('active')) {
                setTimeout(() => {
                    document.addEventListener('click', closeNavMenu);
                }, 100);
            }
        }
        
        function closeNavMenu(e) {
            const dropdown = document.querySelector('.nav-dropdown');
            const menuBtn = document.querySelector('.nav-menu-btn');
            
            if (!dropdown.contains(e.target) && !menuBtn.contains(e.target)) {
                dropdown.classList.remove('active');
                document.removeEventListener('click', closeNavMenu);
            }
        }
        
        // „Çπ„ÉØ„Ç§„Éó„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„ÅÆË®≠ÂÆö
        function setupSwipeNavigation() {
            let touchStartX = 0;
            let touchEndX = 0;
            let touchStartY = 0;
            let touchEndY = 0;
            const mainContent = document.querySelector('.main-content');
            const sections = ['dashboard', 'play', 'calendar', 'daily', 'weekly', 'monthly', 'quarterly', 'completed', 'trash'];
            
            // „Çø„ÉÉ„ÉÅÈñãÂßã
            mainContent.addEventListener('touchstart', function(e) {
                touchStartX = e.changedTouches[0].screenX;
                touchStartY = e.changedTouches[0].screenY;
            }, { passive: true });
            
            // „Çø„ÉÉ„ÉÅÁµÇ‰∫Ü
            mainContent.addEventListener('touchend', function(e) {
                touchEndX = e.changedTouches[0].screenX;
                touchEndY = e.changedTouches[0].screenY;
                handleSwipe();
            }, { passive: true });
            
            function handleSwipe() {
                const swipeDistanceX = touchEndX - touchStartX;
                const swipeDistanceY = Math.abs(touchEndY - touchStartY);
                
                // Á∏¶„Çπ„ÇØ„É≠„Éº„É´„ÅÆÂ†¥Âêà„ÅØÁÑ°Ë¶ñÔºàÊ®™„Çπ„ÉØ„Ç§„Éó„Çà„ÇäÁ∏¶„ÅÆÁßªÂãï„ÅåÂ§ß„Åç„ÅÑÂ†¥ÂêàÔºâ
                if (swipeDistanceY > Math.abs(swipeDistanceX)) {
                    return;
                }
                
                // ÊúÄÂ∞è„Çπ„ÉØ„Ç§„ÉóË∑ùÈõ¢Ôºà50pxÔºâ
                if (Math.abs(swipeDistanceX) < 50) {
                    return;
                }
                
                const currentIndex = sections.indexOf(app.currentSection);
                let newIndex = currentIndex;
                
                if (swipeDistanceX > 0 && currentIndex > 0) {
                    // Âè≥„Çπ„ÉØ„Ç§„ÉóÔºàÂâç„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„Å∏Ôºâ
                    newIndex = currentIndex - 1;
                } else if (swipeDistanceX < 0 && currentIndex < sections.length - 1) {
                    // Â∑¶„Çπ„ÉØ„Ç§„ÉóÔºàÊ¨°„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„Å∏Ôºâ
                    newIndex = currentIndex + 1;
                }
                
                if (newIndex !== currentIndex) {
                    // „Çª„ÇØ„Ç∑„Éß„É≥„ÇíÂàá„ÇäÊõø„Åà
                    const newSection = sections[newIndex];
                    
                    // ÂØæÂøú„Åô„Çã„Çø„Éñ„Éú„Çø„É≥„ÇíË¶ã„Å§„Åë„Å¶„ÇØ„É™„ÉÉ„ÇØ
                    const tabButton = document.querySelector(`.nav-tab[onclick="showSection('${newSection}')"]`);
                    if (tabButton) {
                        tabButton.click();
                    }
                    
                    // „Çπ„ÉØ„Ç§„Éó„ÅÆ„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØÔºàÁîªÈù¢„ÅÆÁ´Ø„Å´Â∞è„Åï„Å™„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ôºâ
                    const indicator = document.createElement('div');
                    indicator.style.cssText = `
                        position: fixed;
                        top: 50%;
                        ${swipeDistanceX > 0 ? 'left: 10px;' : 'right: 10px;'}
                        transform: translateY(-50%);
                        width: 40px;
                        height: 40px;
                        background: var(--primary);
                        border-radius: 50%;
                        opacity: 0.3;
                        pointer-events: none;
                        animation: swipeIndicator 0.3s ease-out;
                    `;
                    document.body.appendChild(indicator);
                    
                    setTimeout(() => {
                        indicator.remove();
                    }, 300);
                }
            }
        }
        
        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆË®≠ÂÆö
        function setupEventListeners() {
            // „É¢„Éº„ÉÄ„É´„ÅÆÂ§ñÂÅ¥„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });
            
            // „Çπ„ÉØ„Ç§„ÉóÊ©üËÉΩ„ÅÆËøΩÂä†
            setupSwipeNavigation();
        }

        // Ë§áÊï∞„Çø„ÉñÂêåÊúüÂá¶ÁêÜ
        function handleStorageChange(e) {
            if (e.key && e.key.startsWith('pdca_')) {
                loadData();
                renderCurrentSection();
                showToast('„Éá„Éº„Çø„ÅåÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü', 'success');
            }
        }

        // ÁèæÂú®„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÂÜçÊèèÁîª
        function renderCurrentSection() {
            if (app.currentSection === 'dashboard') {
                renderDashboard();
            } else if (app.currentSection === 'play') {
                renderIdeas();
            } else if (app.currentSection === 'completed') {
                renderCompletedProjects();
            } else if (app.currentSection === 'trash') {
                renderTrashProjects();
            } else if (app.currentSection === 'weekly') {
                renderWeeklyReport();
            } else if (app.currentSection === 'daily') {
                renderDailyComment();
            } else if (app.currentSection === 'monthly') {
                renderMonthlyInsight();
            } else if (app.currentSection === 'quarterly') {
                renderQuarterlyInsight();
            }
        }

        // „Éà„Éº„Çπ„ÉàÈÄöÁü•
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // „Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø
        function loadData() {
            try {
                app.ideas = JSON.parse(localStorage.getItem(STORAGE_KEYS.IDEAS) || '[]');
                app.projects = JSON.parse(localStorage.getItem(STORAGE_KEYS.PROJECTS) || '[]');
                app.logs = JSON.parse(localStorage.getItem(STORAGE_KEYS.LOGS) || '[]');
                app.improvements = JSON.parse(localStorage.getItem(STORAGE_KEYS.IMPROVEMENTS) || '[]');
                app.apiKey = localStorage.getItem(STORAGE_KEYS.API_KEY);
            } catch (error) {
                console.error('„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:', error);
                showToast('„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'error');
            }
        }

        // „Éá„Éº„Çø„ÅÆ‰øùÂ≠ò
        function saveData() {
            try {
                localStorage.setItem(STORAGE_KEYS.IDEAS, JSON.stringify(app.ideas));
                localStorage.setItem(STORAGE_KEYS.PROJECTS, JSON.stringify(app.projects));
                localStorage.setItem(STORAGE_KEYS.LOGS, JSON.stringify(app.logs));
                localStorage.setItem(STORAGE_KEYS.IMPROVEMENTS, JSON.stringify(app.improvements));
            } catch (error) {
                console.error('„Éá„Éº„Çø„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:', error);
                showToast('„Éá„Éº„Çø„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'error');
            }
        }

        // Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„ÉºÊ©üËÉΩ
        function filterProjects() {
            app.searchQuery = document.getElementById('searchInput').value.toLowerCase();
            renderDashboard();
        }

        function setFilter(phase) {
            app.filterPhase = phase;
            
            // „Éï„Ç£„É´„Çø„Éº„Çø„Ç∞„ÅÆÊõ¥Êñ∞
            document.querySelectorAll('.filter-tag').forEach(tag => {
                tag.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderDashboard();
        }

        // „Çª„ÇØ„Ç∑„Éß„É≥„ÅÆË°®Á§∫Âàá„ÇäÊõø„Åà
        function showSection(sectionName) {
            // „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„É°„Éã„É•„Éº„ÇíÈñâ„Åò„Çã
            const dropdown = document.querySelector('.nav-dropdown');
            if (dropdown) {
                dropdown.classList.remove('active');
            }
            
            // „Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÂàá„ÇäÊõø„Åà
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionName).classList.add('active');
            
            // „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Çø„Éñ„ÅÆÊõ¥Êñ∞
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // „Éú„Éà„É†„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„ÅÆÊõ¥Êñ∞
            document.querySelectorAll('.bottom-nav .nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ÂØæÂøú„Åô„Çã„Éú„Éà„É†„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Ç¢„Ç§„ÉÜ„É†„Çí„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å´
            const navMap = {
                'dashboard': 0,
                'play': 1,
                'weekly': 3,
                'completed': -1,
                'trash': -1
            };
            if (navMap[sectionName] !== undefined && navMap[sectionName] !== -1) {
                document.querySelectorAll('.bottom-nav .nav-item')[navMap[sectionName]].classList.add('active');
            }
            
            app.currentSection = sectionName;
            
            // „Çª„ÇØ„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆÂá¶ÁêÜ
            if (sectionName === 'dashboard') {
                renderDashboard();
            } else if (sectionName === 'play') {
                renderIdeas();
            } else if (sectionName === 'completed') {
                renderCompletedProjects();
            } else if (sectionName === 'trash') {
                renderTrashProjects();
            } else if (sectionName === 'weekly') {
                renderWeeklyReport();
            } else if (sectionName === 'daily') {
                renderDailyComment();
            } else if (sectionName === 'monthly') {
                renderMonthlyInsight();
            } else if (sectionName === 'quarterly') {
                renderQuarterlyInsight();
            } else if (sectionName === 'calendar') {
                renderCalendar();
            }
        }

        // „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÅÆÊèèÁîª
        function renderDashboard() {
            const grid = document.getElementById('projectGrid');
            const emptyState = document.getElementById('emptyState');
            
            let activeProjects = app.projects.filter(p => !p.completed && !p.deleted);
            
            // Ê§úÁ¥¢„Éï„Ç£„É´„Çø„Éº
            if (app.searchQuery) {
                activeProjects = activeProjects.filter(p => 
                    p.name.toLowerCase().includes(app.searchQuery) ||
                    p.goal.toLowerCase().includes(app.searchQuery)
                );
            }
            
            // „Éï„Çß„Éº„Ç∫„Éï„Ç£„É´„Çø„Éº
            if (app.filterPhase !== 'all') {
                activeProjects = activeProjects.filter(p => p.phase === app.filterPhase);
            }
            
            if (activeProjects.length === 0) {
                grid.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            grid.innerHTML = activeProjects.map(project => {
                const progress = calculateProjectProgress(project);
                const phaseColors = {
                    'Play': '#6366f1',
                    'Design': '#f59e0b',
                    'Check': '#10b981',
                    'Adapt': '#ef4444'
                };
                
                // „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„Åî„Å®„ÅÆÈÅîÊàêÁéá„ÇíË®àÁÆó
                const checkpointStats = calculateCheckpointStats(project);
                
                return `
                    <div class="project-card" onclick="showProjectDetail('${project.id}')">
                        <div class="trash-icon" onclick="moveToTrash(event, '${project.id}')">üóëÔ∏è</div>
                        <div class="project-header">
                            <div>
                                <div class="project-title">${project.name}</div>
                                <div style="font-size: 0.875rem; color: var(--gray);">${project.duration}Êó•Èñì</div>
                            </div>
                            <div class="project-phase" style="background: ${phaseColors[project.phase] || phaseColors.Play}">
                                ${project.phase}
                            </div>
                        </div>
                        
                        <div class="project-stats">
                            <div class="stat-item">
                                <div class="stat-value">${progress}%</div>
                                <div class="stat-label">Á∑èÂêàÈÄ≤Êçó</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${getProjectDaysLeft(project)}</div>
                                <div class="stat-label">ÊÆã„ÇäÊó•Êï∞</div>
                            </div>
                        </div>
                        
                        ${project.trackingType === 'daily' && checkpointStats.length > 0 ? `
                            <div class="checkpoint-progress">
                                ${checkpointStats.map(stat => `
                                    <div class="checkpoint-item">
                                        <span class="checkpoint-name">${stat.name}</span>
                                        <span class="checkpoint-rate">${stat.rate}%</span>
                                        <div class="mini-progress">
                                            <div class="mini-progress-fill" style="width: ${stat.rate}%"></div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                        
                        ${project.trackingType === 'count' ? renderCounterSection(project) : ''}
                        
                        ${project.trackingType === 'milestone' ? renderMilestoneProgress(project) : ''}
                        
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                        
                        ${renderPhaseActions(project)}
                    </div>
                `;
            }).join('');
        }

        // „Ç¥„ÉüÁÆ±„Å∏ÁßªÂãï
        function moveToTrash(event, projectId) {
            event.stopPropagation();
            
            const project = app.projects.find(p => p.id === projectId);
            if (project) {
                project.deleted = true;
                project.deletedAt = new Date().toISOString();
                saveData();
                renderDashboard();
                showToast('„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çí„Ç¥„ÉüÁÆ±„Å´ÁßªÂãï„Åó„Åæ„Åó„Åü', 'success');
            }
        }

        // „Ç¥„ÉüÁÆ±„Åã„ÇâÂæ©ÂÖÉ
        function restoreFromTrash(event, projectId) {
            event.stopPropagation();
            
            const project = app.projects.find(p => p.id === projectId);
            if (project) {
                delete project.deleted;
                delete project.deletedAt;
                saveData();
                renderTrashProjects();
                showToast('„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂæ©ÂÖÉ„Åó„Åæ„Åó„Åü', 'success');
            }
        }

        // „Ç¥„ÉüÁÆ±„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÊèèÁîª
        function renderTrashProjects() {
            const grid = document.getElementById('trashGrid');
            const emptyState = document.getElementById('trashEmpty');
            
            const deletedProjects = app.projects.filter(p => p.deleted);
            
            if (deletedProjects.length === 0) {
                grid.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            grid.innerHTML = deletedProjects.map(project => {
                const deletedDate = new Date(project.deletedAt);
                
                return `
                    <div class="project-card" style="opacity: 0.7;">
                        <div class="project-header">
                            <div>
                                <div class="project-title">${project.name}</div>
                                <div style="font-size: 0.875rem; color: var(--gray);">
                                    ÂâäÈô§Êó•: ${formatDate(deletedDate)}
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                            <button class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.875rem;"
                                    onclick="restoreFromTrash(event, '${project.id}')">
                                Âæ©ÂÖÉ„Åô„Çã
                            </button>
                            <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.875rem;"
                                    onclick="permanentlyDelete(event, '${project.id}')">
                                ÂÆåÂÖ®„Å´ÂâäÈô§
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ÂÆåÂÖ®ÂâäÈô§
        function permanentlyDelete(event, projectId) {
            event.stopPropagation();
            
            if (confirm('„Åì„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂÆåÂÖ®„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ')) {
                app.projects = app.projects.filter(p => p.id !== projectId);
                app.logs = app.logs.filter(log => log.projectId !== projectId);
                saveData();
                renderTrashProjects();
                showToast('„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂÆåÂÖ®„Å´ÂâäÈô§„Åó„Åæ„Åó„Åü', 'success');
            }
        }

        // „Ç¥„ÉüÁÆ±„ÇíÁ©∫„Å´„Åô„Çã
        function emptyTrash() {
            if (confirm('„Ç¥„ÉüÁÆ±ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂÆåÂÖ®„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ')) {
                const deletedProjectIds = app.projects
                    .filter(p => p.deleted)
                    .map(p => p.id);
                
                app.projects = app.projects.filter(p => !p.deleted);
                app.logs = app.logs.filter(log => !deletedProjectIds.includes(log.projectId));
                
                saveData();
                renderTrashProjects();
                showToast('„Ç¥„ÉüÁÆ±„ÇíÁ©∫„Å´„Åó„Åæ„Åó„Åü', 'success');
            }
        }

        // „Ç´„Ç¶„É≥„Çø„Éº„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÊèèÁîª
        function renderCounterSection(project) {
            if (!project.countItems) return '';
            
            return `
                <div class="counter-section">
                    ${project.countItems.map((item, index) => {
                        const count = getProjectCountForItem(project.id, index);
                        return `
                            <div class="counter-item">
                                <span class="counter-label">${item}</span>
                                <div class="counter-controls">
                                    <button class="counter-btn" onclick="incrementCount(event, '${project.id}', ${index}, -1)">‚àí</button>
                                    <span class="counter-value" onclick="editCount(event, '${project.id}', ${index})" id="count_${project.id}_${index}">${count}</span>
                                    <button class="counter-btn" onclick="incrementCount(event, '${project.id}', ${index}, 1)">+</button>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥ÈÄ≤Êçó„ÅÆÊèèÁîª
        function renderMilestoneProgress(project) {
            if (!project.milestones) return '';
            
            const achievedCount = getMilestoneAchievedCount(project);
            return `
                <div style="margin-top: 1rem;">
                    <div style="font-size: 0.875rem; color: var(--gray);">
                        ÈÅîÊàêÊ∏à„Åø: ${achievedCount} / ${project.milestones.length}
                    </div>
                </div>
            `;
        }

        // ÂÆå‰∫Ü„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÊèèÁîª
        function renderCompletedProjects() {
            const grid = document.getElementById('completedGrid');
            const emptyState = document.getElementById('completedEmpty');
            
            const completedProjects = app.projects.filter(p => p.completed && !p.deleted);
            
            if (completedProjects.length === 0) {
                grid.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            grid.innerHTML = completedProjects.map(project => {
                const completedDate = project.completedAt ? new Date(project.completedAt) : null;
                
                return `
                    <div class="project-card completed" onclick="showProjectDetail('${project.id}')">
                        <div class="project-header">
                            <div>
                                <div class="project-title">
                                    ${project.name}
                                    <span class="completed-badge">ÂÆå‰∫Ü</span>
                                </div>
                                <div style="font-size: 0.875rem; color: var(--gray);">
                                    ${completedDate ? `ÂÆå‰∫ÜÊó•: ${formatDate(completedDate)}` : ''}
                                </div>
                            </div>
                        </div>
                        
                        <div class="project-stats">
                            <div class="stat-item">
                                <div class="stat-value">${project.duration}</div>
                                <div class="stat-label">ÂÆüÊñΩÊó•Êï∞</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${project.cycleCount || 1}</div>
                                <div class="stat-label">„Çµ„Ç§„ÇØ„É´Êï∞</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.875rem;"
                                    onclick="reactivateProject(event, '${project.id}')">
                                ÂÜçÈñã„Åô„Çã
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // „Éï„Çß„Éº„Ç∫„Åî„Å®„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥Ë°®Á§∫
        function renderPhaseActions(project) {
            const actions = {
                'Play': [
                    { icon: 'üí°', text: '„Ç¢„Ç§„Éá„Ç¢„ÇíÂÖ∑‰ΩìÂåñ', action: 'moveToDesign' }
                ],
                'Design': [
                    { icon: '‚ñ∂Ô∏è', text: 'ÂÆüË°åÈñãÂßã', action: 'moveToCheck' },
                    { icon: '‚óÄÔ∏è', text: '„Ç¢„Ç§„Éá„Ç¢„Å´Êàª„Åô', action: 'moveToPlay' }
                ],
                'Check': [
                    { icon: 'üìù', text: '‰ªäÊó•„ÅÆË®òÈå≤', action: 'showDailyLog' },
                    { icon: 'üìä', text: 'ÈÄ≤Êçó„ÇíÂàÜÊûê', action: 'analyzeProgress' },
                    { icon: 'üîÑ', text: 'ÊîπÂñÑ„Éï„Çß„Éº„Ç∫„Å∏', action: 'moveToAdapt' },
                    { icon: '‚óÄÔ∏è', text: 'Ë®≠Ë®à„Å´Êàª„Çã', action: 'moveToDesign' }
                ],
                'Adapt': [
                    { icon: 'üìù', text: 'ÊîπÂñÑÁÇπ„É°„É¢', action: 'showImprovements' },
                    { icon: '‚úÖ', text: '„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂÆå‰∫Ü', action: 'completeProject' },
                    { icon: 'üîÑ', text: 'ÂÜçË®≠Ë®à„Åô„Çã', action: 'moveToDesign' },
                    { icon: '‚ñ∂Ô∏è', text: 'ÂÆüË°å„Å´Êàª„Çã', action: 'moveToCheck' }
                ]
            };

            const phaseActions = actions[project.phase] || [];
            if (phaseActions.length === 0) return '';

            return `
                <div class="phase-actions">
                    ${phaseActions.map(action => `
                        <div class="phase-action" onclick="handlePhaseAction(event, '${project.id}', '${action.action}')">
                            <span class="phase-action-icon">${action.icon}</span>
                            <span>${action.text}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // „Éï„Çß„Éº„Ç∫„Ç¢„ÇØ„Ç∑„Éß„É≥„ÅÆ„Éè„É≥„Éâ„É©„Éº
        function handlePhaseAction(event, projectId, action) {
            event.stopPropagation();
            
            switch (action) {
                case 'moveToPlay':
                    moveToPhase(projectId, 'Play');
                    break;
                case 'moveToDesign':
                    moveToPhase(projectId, 'Design');
                    break;
                case 'showDailyLog':
                    showDailyLog(projectId);
                    break;
                case 'moveToCheck':
                    moveToPhase(projectId, 'Check');
                    break;
                case 'analyzeProgress':
                    analyzeProjectProgress(projectId);
                    break;
                case 'moveToAdapt':
                    moveToPhase(projectId, 'Adapt');
                    break;
                case 'showImprovements':
                    showImprovementModal(projectId);
                    break;
                case 'completeProject':
                    completeProject(projectId);
                    break;
                case 'restartCycle':
                    restartProjectCycle(projectId);
                    break;
            }
        }

        // „Ç´„Ç¶„É≥„Éà„ÅÆÂ¢óÊ∏õ
        function incrementCount(event, projectId, itemIndex, delta) {
            event.stopPropagation();
            
            const log = {
                id: Date.now().toString(),
                projectId: projectId,
                date: new Date().toISOString(),
                type: 'count',
                itemIndex: itemIndex,
                value: delta
            };
            
            app.logs.push(log);
            saveData();
            
            // „Ç´„Ç¶„É≥„ÉàË°®Á§∫„ÇíÊõ¥Êñ∞
            const countElement = document.getElementById(`count_${projectId}_${itemIndex}`);
            if (countElement) {
                const newCount = getProjectCountForItem(projectId, itemIndex);
                countElement.textContent = newCount;
            }
            
            showToast(`„Ç´„Ç¶„É≥„Éà„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü: ${delta > 0 ? '+' : ''}${delta}`, 'success');
        }

        // „Ç´„Ç¶„É≥„Éà„ÅÆÁõ¥Êé•Á∑®ÈõÜ
        function editCount(event, projectId, itemIndex) {
            event.stopPropagation();
            
            const countElement = event.target;
            const currentCount = getProjectCountForItem(projectId, itemIndex);
            
            // input„Å´ÁΩÆ„ÅçÊèõ„Åà
            const input = document.createElement('input');
            input.type = 'number';
            input.className = 'counter-input';
            input.value = currentCount;
            input.onclick = (e) => e.stopPropagation();
            
            input.onblur = () => {
                const newValue = parseInt(input.value) || 0;
                const delta = newValue - currentCount;
                
                if (delta !== 0) {
                    const log = {
                        id: Date.now().toString(),
                        projectId: projectId,
                        date: new Date().toISOString(),
                        type: 'count',
                        itemIndex: itemIndex,
                        value: delta
                    };
                    
                    app.logs.push(log);
                    saveData();
                    showToast('„Ç´„Ç¶„É≥„Éà„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü', 'success');
                }
                
                // ÂÖÉ„ÅÆË°®Á§∫„Å´Êàª„Åô
                countElement.textContent = newValue;
                countElement.style.display = '';
                input.remove();
            };
            
            input.onkeypress = (e) => {
                if (e.key === 'Enter') {
                    input.blur();
                }
            };
            
            countElement.style.display = 'none';
            countElement.parentElement.insertBefore(input, countElement.nextSibling);
            input.focus();
            input.select();
        }

        // ÁâπÂÆöÈ†ÖÁõÆ„ÅÆ„Ç´„Ç¶„É≥„ÉàÂèñÂæó
        function getProjectCountForItem(projectId, itemIndex) {
            return app.logs.filter(log => 
                log.projectId === projectId && 
                log.type === 'count' &&
                log.itemIndex === itemIndex
            ).reduce((sum, log) => sum + (log.value || 0), 0);
        }

        // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥ÈÅîÊàêÊï∞„ÅÆÂèñÂæó
        function getMilestoneAchievedCount(project) {
            const milestoneLogs = app.logs.filter(log =>
                log.projectId === project.id &&
                log.type === 'milestone'
            );
            
            const achievedMilestones = new Set();
            milestoneLogs.forEach(log => {
                if (log.achieved) {
                    achievedMilestones.add(log.milestoneIndex);
                }
            });
            
            return achievedMilestones.size;
        }

        // „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„Åî„Å®„ÅÆÁµ±Ë®à„ÇíË®àÁÆó
        function calculateCheckpointStats(project) {
            if (project.trackingType !== 'daily' || !project.checkpoints) return [];
            
            const projectLogs = app.logs.filter(log => log.projectId === project.id);
            
            return project.checkpoints.map((checkpoint, index) => {
                const completedCount = projectLogs.filter(log => 
                    log.checkpoints && log.checkpoints[index] === true
                ).length;
                
                const totalDays = Math.min(
                    Math.floor((new Date() - new Date(project.startDate)) / (1000 * 60 * 60 * 24)) + 1,
                    project.duration
                );
                
                const rate = totalDays > 0 ? Math.round((completedCount / totalDays) * 100) : 0;
                
                return {
                    name: checkpoint,
                    completedCount,
                    totalDays,
                    rate
                };
            });
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈÄ≤Êçó„ÅÆÂàÜÊûê
        function analyzeProjectProgress(projectId) {
            const project = app.projects.find(p => p.id === projectId);
            if (!project) return;
            
            const stats = calculateCheckpointStats(project);
            const overallProgress = calculateProjectProgress(project);
            
            let analysis = `üìä ${project.name} „ÅÆÈÄ≤ÊçóÂàÜÊûê\n\n`;
            analysis += `Á∑èÂêàÈÄ≤Êçó: ${overallProgress}%\n`;
            analysis += `ÁµåÈÅéÊó•Êï∞: ${Math.floor((new Date() - new Date(project.startDate)) / (1000 * 60 * 60 * 24)) + 1}Êó•\n\n`;
            
            if (stats.length > 0) {
                analysis += `È†ÖÁõÆÂà•ÈÅîÊàêÁéá:\n`;
                stats.forEach(stat => {
                    analysis += `‚Ä¢ ${stat.name}: ${stat.rate}% (${stat.completedCount}/${stat.totalDays}Êó•)\n`;
                });
                
                // ÊúÄ„ÇÇÈÅîÊàêÁéá„ÅåÈ´ò„ÅÑÈ†ÖÁõÆ„Å®‰Ωé„ÅÑÈ†ÖÁõÆ„ÇíÁâπÂÆö
                const bestItem = stats.reduce((best, current) => 
                    current.rate > best.rate ? current : best
                );
                const worstItem = stats.reduce((worst, current) => 
                    current.rate < worst.rate ? current : worst
                );
                
                analysis += `\nüí™ ÊúÄ„ÇÇÈ†ÜË™ø: ${bestItem.name} (${bestItem.rate}%)\n`;
                analysis += `‚ö†Ô∏è Ë¶ÅÊîπÂñÑ: ${worstItem.name} (${worstItem.rate}%)\n`;
            }
            
            alert(analysis);
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÂâäÈô§
        function deleteProject(event, projectId) {
            event.stopPropagation();
            
            if (confirm('„Åì„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                moveToTrash(event, projectId);
            }
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆ„Ç´„Ç¶„É≥„ÉàÂèñÂæó
        function getProjectCount(project) {
            return app.logs.filter(log => 
                log.projectId === project.id && 
                log.type === 'count'
            ).reduce((sum, log) => sum + (log.value || 1), 0);
        }

        // „É¢„Éº„ÉÄ„É´Ë°®Á§∫
        function showAddModal() {
            document.getElementById('addModal').classList.add('active');
            document.getElementById('ideaContent').value = '';
        }

        function showProjectDetail(projectId) {
            const project = app.projects.find(p => p.id === projectId);
            if (!project) return;
            
            const modal = document.getElementById('projectModal');
            const title = document.getElementById('projectModalTitle');
            const body = document.getElementById('projectModalBody');
            
            title.textContent = project.name;
            
            // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆË©≥Á¥∞Ë°®Á§∫
            const logs = app.logs.filter(log => log.projectId === projectId);
            const completedDays = logs.filter(log => log.completed).length;
            const checkpointStats = calculateCheckpointStats(project);
            
            body.innerHTML = `
                <div class="form-group">
                    <label class="form-label">„Ç¥„Éº„É´</label>
                    <div style="padding: 1rem; background: var(--light-gray); border-radius: var(--radius);">
                        ${project.goal}
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÁèæÂú®„ÅÆ„Éï„Çß„Éº„Ç∫: ${project.phase}</label>
                    <div style="padding: 1rem; background: var(--light-gray); border-radius: var(--radius);">
                        ${getPhaseDescription(project.phase)}
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÈÄ≤ÊçóÁä∂Ê≥Å</label>
                    <div class="project-stats" style="margin-top: 0;">
                        <div class="stat-item">
                            <div class="stat-value">${completedDays}</div>
                            <div class="stat-label">ÂÆüË°åÊó•Êï∞</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${project.duration}</div>
                            <div class="stat-label">ÁõÆÊ®ôÊó•Êï∞</div>
                        </div>
                    </div>
                </div>
                
                ${project.trackingType === 'daily' && checkpointStats.length > 0 ? `
                    <div class="form-group">
                        <label class="form-label">„ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„ÉàÂà•ÈÅîÊàêÁéá</label>
                        ${checkpointStats.map(stat => `
                            <div class="checkpoint-item">
                                <span class="checkpoint-name">${stat.name}</span>
                                <span class="checkpoint-rate">${stat.rate}% (${stat.completedCount}/${stat.totalDays}Êó•)</span>
                                <div class="mini-progress">
                                    <div class="mini-progress-fill" style="width: ${stat.rate}%"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${project.trackingType === 'count' && project.countItems ? `
                    <div class="form-group">
                        <label class="form-label">„Ç´„Ç¶„É≥„ÉàÈÄ≤Êçó</label>
                        ${project.countItems.map((item, index) => `
                            <div style="padding: 0.5rem; background: var(--light-gray); border-radius: var(--radius); margin-bottom: 0.5rem;">
                                ${item}: ${getProjectCountForItem(project.id, index)}
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${project.trackingType === 'milestone' && project.milestones ? `
                    <div class="form-group">
                        <label class="form-label">„Éû„Ç§„É´„Çπ„Éà„Éº„É≥</label>
                        ${project.milestones.map((milestone, index) => {
                            const isAchieved = isMilestoneAchieved(project.id, index);
                            return `
                                <div class="milestone-item">
                                    <span class="${isAchieved ? 'milestone-achieved' : ''}">${milestone}</span>
                                    ${isAchieved ? '‚úÖ' : '‚≠ï'}
                                </div>
                            `;
                        }).join('')}
                    </div>
                ` : ''}
            `;
            
            modal.classList.add('active');
        }

        function showSettings() {
            const modal = document.getElementById('settingsModal');
            updateNotificationStatus();
            modal.classList.add('active');
        }

        function showAPIKeyModal() {
            closeModal('settingsModal');
            const modal = document.getElementById('apiKeyModal');
            const apiKeyInput = document.getElementById('apiKey');
            apiKeyInput.value = app.apiKey || '';
            modal.classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // ÊîπÂñÑÁÇπ„É°„É¢„É¢„Éº„ÉÄ„É´„ÅÆË°®Á§∫
        function showImprovementModal(projectId) {
            app.currentProjectId = projectId;
            const modal = document.getElementById('improvementModal');
            const project = app.projects.find(p => p.id === projectId);
            
            if (!project) return;
            
            // „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂêç„Çí„Çø„Ç§„Éà„É´„Å´Ë°®Á§∫
            const modalTitle = modal.querySelector('.modal-title');
            modalTitle.textContent = `ÊîπÂñÑÁÇπ„É°„É¢ - ${project.name}`;
            
            // ÊîπÂñÑÁÇπ„É™„Çπ„Éà„ÇíË°®Á§∫
            renderImprovementsList(projectId);
            
            // „ÉÜ„Ç≠„Çπ„Éà„Ç®„É™„Ç¢„Çí„ÇØ„É™„Ç¢
            document.getElementById('newImprovement').value = '';
            
            modal.classList.add('active');
        }

        // ÊîπÂñÑÁÇπ„É°„É¢„ÅÆËøΩÂä†
        function addImprovementMemo() {
            const content = document.getElementById('newImprovement').value.trim();
            if (!content) return;
            
            const improvement = {
                id: Date.now().toString(),
                projectId: app.currentProjectId,
                content: content,
                createdAt: new Date().toISOString(),
                type: 'memo' // 'daily'„Å®Âå∫Âà•„Åô„Çã„Åü„ÇÅ
            };
            
            app.improvements.push(improvement);
            saveData();
            
            document.getElementById('newImprovement').value = '';
            renderImprovementsList(app.currentProjectId);
            
            showToast('ÊîπÂñÑÁÇπ„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü', 'success');
        }

        // ÊîπÂñÑÁÇπ„É™„Çπ„Éà„ÅÆË°®Á§∫
        function renderImprovementsList(projectId) {
            const listDiv = document.getElementById('improvementsList');
            const projectImprovements = app.improvements
                .filter(imp => imp.projectId === projectId)
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            if (projectImprovements.length === 0) {
                listDiv.innerHTML = '<div style="text-align: center; color: var(--gray); padding: 2rem;">„Åæ„Å†ÊîπÂñÑÁÇπ„É°„É¢„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                return;
            }
            
            listDiv.innerHTML = `
                <h4 style="margin-bottom: 1rem;">ÊîπÂñÑÁÇπÂ±•Ê≠¥</h4>
                ${projectImprovements.map(imp => {
                    const date = new Date(imp.createdAt);
                    const dateStr = `${date.getMonth() + 1}/${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2, '0')}`;
                    
                    return `
                        <div style="background: var(--light-gray); padding: 1rem; border-radius: var(--radius); margin-bottom: 0.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div style="flex: 1;">
                                    <div style="font-size: 0.75rem; color: var(--gray); margin-bottom: 0.25rem;">${dateStr}</div>
                                    <div style="white-space: pre-wrap;">${imp.content}</div>
                                </div>
                                <button onclick="deleteImprovement('${imp.id}')" style="background: none; border: none; color: var(--danger); cursor: pointer; padding: 0.25rem;">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                    `;
                }).join('')}
            `;
        }

        // ÊîπÂñÑÁÇπ„ÅÆÂâäÈô§
        function deleteImprovement(improvementId) {
            if (confirm('„Åì„ÅÆÊîπÂñÑÁÇπ„É°„É¢„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                app.improvements = app.improvements.filter(imp => imp.id !== improvementId);
                saveData();
                renderImprovementsList(app.currentProjectId);
                showToast('ÊîπÂñÑÁÇπ„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü', 'success');
            }
        }

        // „Ç¢„Ç§„Éá„Ç¢„ÅÆËøΩÂä†
        function addIdea() {
            const content = document.getElementById('ideaContent').value.trim();
            
            if (!content) return;
            
            const idea = {
                id: Date.now().toString(),
                content: content,
                createdAt: new Date().toISOString()
            };
            
            app.ideas.push(idea);
            saveData();
            
            closeModal('addModal');
            renderIdeas();
            
            showToast('„Ç¢„Ç§„Éá„Ç¢„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü', 'success');
        }

        // „Ç¢„Ç§„Éá„Ç¢„É™„Çπ„Éà„ÅÆÊèèÁîª
        function renderIdeas() {
            const list = document.getElementById('inboxList');
            const emptyState = document.getElementById('inboxEmpty');
            
            if (app.ideas.length === 0) {
                list.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            list.innerHTML = app.ideas.map(idea => `
                <div class="inbox-item">
                    <div class="inbox-content">
                        <div>${idea.content}</div>
                        <div class="inbox-date">${formatDate(new Date(idea.createdAt))}</div>
                    </div>
                    <button class="inbox-action" onclick="startDesign('${idea.id}')">
                        „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂåñ
                    </button>
                </div>
            `).join('');
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„ÉàË®≠Ë®àÈñãÂßã
        function startDesign(ideaId) {
            const idea = app.ideas.find(i => i.id === ideaId);
            if (!idea) return;
            
            // „Ç¢„Ç§„Éá„Ç¢„Çí‰∏ÄÊôÇ‰øùÂ≠ò
            app.currentIdeaId = ideaId;
            
            // „Éá„Ç∂„Ç§„É≥„É¢„Éº„ÉÄ„É´„ÇíÈñã„Åè
            const modal = document.getElementById('designModal');
            document.getElementById('projectName').value = idea.content;
            document.getElementById('projectGoal').value = '';
            document.getElementById('projectDuration').value = '30';
            document.getElementById('trackingType').value = 'daily';
            updateTrackingUI();
            
            modal.classList.add('active');
        }

        // „Éà„É©„ÉÉ„Ç≠„É≥„Ç∞UI„ÅÆÊõ¥Êñ∞
        function updateTrackingUI() {
            const trackingType = document.getElementById('trackingType').value;
            
            document.getElementById('dailyCheckGroup').style.display = 
                trackingType === 'daily' ? 'block' : 'none';
            document.getElementById('countGroup').style.display = 
                trackingType === 'count' ? 'block' : 'none';
            document.getElementById('milestoneGroup').style.display = 
                trackingType === 'milestone' ? 'block' : 'none';
        }

        // „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„ÉàËøΩÂä†
        function addCheckpoint() {
            const container = document.getElementById('checkpoints');
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'form-control';
            input.style.marginBottom = '0.5rem';
            input.placeholder = '‰æã: „Çπ„Éà„É¨„ÉÉ„ÉÅ„Çí5ÂàÜÂÆüÊñΩ';
            container.appendChild(input);
        }

        // „Ç´„Ç¶„É≥„ÉàÈ†ÖÁõÆËøΩÂä†
        function addCountItem() {
            const container = document.getElementById('countItems');
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'form-control';
            input.style.marginBottom = '0.5rem';
            input.placeholder = '‰æã: ËÖπÁ≠ã„ÅÆÂõûÊï∞';
            container.appendChild(input);
        }

        // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥ËøΩÂä†
        function addMilestone() {
            const container = document.getElementById('milestones');
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'form-control';
            input.style.marginBottom = '0.5rem';
            input.placeholder = '‰æã: 100ÂõûÈÄ£Á∂ö„ÅßËÖπÁ≠ã„Åå„Åß„Åç„Çã';
            container.appendChild(input);
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆ‰ΩúÊàê
        function createProject() {
            const name = document.getElementById('projectName').value.trim();
            const goal = document.getElementById('projectGoal').value.trim();
            const duration = parseInt(document.getElementById('projectDuration').value);
            const trackingType = document.getElementById('trackingType').value;
            
            if (!name || !goal) {
                alert('„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂêç„Å®„Ç¥„Éº„É´„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            const project = {
                id: Date.now().toString(),
                name: name,
                goal: goal,
                duration: duration,
                trackingType: trackingType,
                phase: 'Design',
                startDate: new Date().toISOString(),
                createdAt: new Date().toISOString(),
                cycleCount: 1
            };
            
            // „Éà„É©„ÉÉ„Ç≠„É≥„Ç∞„Çø„Ç§„Éó„Å´Âøú„Åò„Å¶È†ÖÁõÆ„ÇíËøΩÂä†
            if (trackingType === 'daily') {
                const checkpoints = Array.from(document.querySelectorAll('#checkpoints input'))
                    .map(input => input.value.trim())
                    .filter(value => value);
                
                if (checkpoints.length === 0) {
                    alert('Â∞ë„Å™„Åè„Å®„ÇÇ1„Å§„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }
                
                project.checkpoints = checkpoints;
            } else if (trackingType === 'count') {
                const countItems = Array.from(document.querySelectorAll('#countItems input'))
                    .map(input => input.value.trim())
                    .filter(value => value);
                
                if (countItems.length === 0) {
                    alert('Â∞ë„Å™„Åè„Å®„ÇÇ1„Å§„ÅÆ„Ç´„Ç¶„É≥„ÉàÈ†ÖÁõÆ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }
                
                project.countItems = countItems;
            } else if (trackingType === 'milestone') {
                const milestones = Array.from(document.querySelectorAll('#milestones input'))
                    .map(input => input.value.trim())
                    .filter(value => value);
                
                if (milestones.length === 0) {
                    alert('Â∞ë„Å™„Åè„Å®„ÇÇ1„Å§„ÅÆ„Éû„Ç§„É´„Çπ„Éà„Éº„É≥„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }
                
                project.milestones = milestones;
            }
            
            // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíËøΩÂä†
            app.projects.push(project);
            
            // ÂÖÉ„ÅÆ„Ç¢„Ç§„Éá„Ç¢„ÇíÂâäÈô§
            if (app.currentIdeaId) {
                app.ideas = app.ideas.filter(i => i.id !== app.currentIdeaId);
                app.currentIdeaId = null;
            }
            
            saveData();
            closeModal('designModal');
            showSection('dashboard');
            
            showToast('„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çí‰ΩúÊàê„Åó„Åæ„Åó„Åü', 'success');
        }

        // Êó•Ê¨°„É≠„Ç∞„ÅÆË°®Á§∫
        function showDailyLog(projectId) {
            // ÁâπÂÆö„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆ„É≠„Ç∞„ÇíË°®Á§∫
            if (projectId) {
                app.currentProjectId = projectId;
            } else {
                // „É™„Éû„Ç§„É≥„ÉÄ„Éº„Åã„ÇâÊù•„ÅüÂ†¥Âêà„ÅØ„ÄÅ„ÉÅ„Çß„ÉÉ„ÇØ„Éï„Çß„Éº„Ç∫„ÅÆÂÖ®„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíË°®Á§∫
                app.currentProjectId = null;
            }
            
            const modal = document.getElementById('logModal');
            const body = document.getElementById('logModalBody');
            
            const today = new Date().toDateString();
            const projects = app.currentProjectId 
                ? app.projects.filter(p => p.id === app.currentProjectId)
                : app.projects.filter(p => p.phase === 'Check' && !p.completed && !p.deleted);
            
            const dailyProjects = projects.filter(p => p.trackingType === 'daily');
            const countProjects = projects.filter(p => p.trackingType === 'count');
            const milestoneProjects = projects.filter(p => p.trackingType === 'milestone');
            
            let html = '';
            
            // ÊîπÂñÑÁÇπ„ÉªÈÅ©Âøú‰∫ãÈ†Ö„ÅÆÂÖ•Âäõ„Éï„Ç£„Éº„É´„Éâ
            html += `
                <div style="margin-bottom: 2rem;">
                    <h4 style="margin-bottom: 1rem;">‰ªäÊó•„ÅÆÊîπÂñÑÁÇπ„ÉªÈÅ©Âøú‰∫ãÈ†Ö</h4>
                    <textarea 
                        id="dailyImprovements" 
                        class="form-control" 
                        rows="3" 
                        placeholder="‰ªäÊó•ÂÆüÊñΩ„Åó„ÅüÊîπÂñÑÁÇπ„ÇÑ„ÄÅÊñ∞„Åó„ÅèÈÅ©Âøú„Åó„Åü„Åì„Å®„ÇíË®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ&#10;‰æãÔºö‰ΩúÊ•≠ÊôÇÈñì„ÇíÊúù„Å´Â§âÊõ¥„Åó„Åü„ÄÅÊñ∞„Åó„ÅÑ„ÉÑ„Éº„É´„ÇíÂ∞éÂÖ•„Åó„Åü„ÄÅ„Å™„Å©"
                        style="width: 100%; resize: vertical;"
                    >${getTodayImprovements()}</textarea>
                </div>
            `;
            
            // ÊØéÊó•„ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Éó„É≠„Ç∏„Çß„ÇØ„Éà
            if (dailyProjects.length > 0) {
                html += '<h4 style="margin-bottom: 1rem;">‰ªäÊó•„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØÈ†ÖÁõÆ</h4>';
                dailyProjects.forEach(project => {
                    const todayLog = app.logs.find(log => 
                        log.projectId === project.id && 
                        new Date(log.date).toDateString() === today
                    );
                    
                    html += `
                        <div style="margin-bottom: 1.5rem;">
                            <h5 style="margin-bottom: 0.5rem;">${project.name}</h5>
                            ${project.checkpoints.map((checkpoint, index) => `
                                <div class="checkbox-group">
                                    <input type="checkbox" 
                                           id="check_${project.id}_${index}"
                                           ${todayLog && todayLog.checkpoints && todayLog.checkpoints[index] ? 'checked' : ''}>
                                    <label for="check_${project.id}_${index}" class="checkbox-label">
                                        ${checkpoint}
                                    </label>
                                </div>
                            `).join('')}
                        </div>
                    `;
                });
            }
            
            // „Ç´„Ç¶„É≥„Éà„Åô„Çã„Éó„É≠„Ç∏„Çß„ÇØ„Éà
            if (countProjects.length > 0) {
                html += '<h4 style="margin-top: 2rem; margin-bottom: 1rem;">„Ç´„Ç¶„É≥„ÉàÈ†ÖÁõÆ</h4>';
                countProjects.forEach(project => {
                    html += `
                        <div style="margin-bottom: 1.5rem;">
                            <h5 style="margin-bottom: 0.5rem;">${project.name}</h5>
                            ${project.countItems.map((item, index) => {
                                const count = getProjectCountForItem(project.id, index);
                                return `
                                    <div class="counter-item">
                                        <span class="counter-label">${item}</span>
                                        <div class="counter-controls">
                                            <button class="counter-btn" onclick="incrementCount(event, '${project.id}', ${index}, -1)">‚àí</button>
                                            <span class="counter-value" id="modal_count_${project.id}_${index}">${count}</span>
                                            <button class="counter-btn" onclick="incrementCount(event, '${project.id}', ${index}, 1)">+</button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                });
            }
            
            // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥„Éó„É≠„Ç∏„Çß„ÇØ„Éà
            if (milestoneProjects.length > 0) {
                html += '<h4 style="margin-top: 2rem; margin-bottom: 1rem;">„Éû„Ç§„É´„Çπ„Éà„Éº„É≥ÈÅîÊàê</h4>';
                milestoneProjects.forEach(project => {
                    html += `
                        <div style="margin-bottom: 1.5rem;">
                            <h5 style="margin-bottom: 0.5rem;">${project.name}</h5>
                            ${project.milestones.map((milestone, index) => {
                                const achieved = isMilestoneAchieved(project.id, index);
                                const tempKey = `milestone_${project.id}_${index}`;
                                const tempAchieved = sessionStorage.getItem(tempKey) === 'true';
                                
                                return `
                                    <div class="milestone-item">
                                        <input type="checkbox" 
                                               class="milestone-checkbox"
                                               id="milestone_${project.id}_${index}"
                                               ${achieved || tempAchieved ? 'checked' : ''}
                                               onchange="toggleMilestone('${project.id}', ${index}, this.checked)">
                                        <label for="milestone_${project.id}_${index}" 
                                               class="milestone-text ${achieved || tempAchieved ? 'milestone-achieved' : ''}">
                                            ${milestone}
                                        </label>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                });
            }
            
            if (html === '') {
                html = '<p style="text-align: center; color: var(--gray);">Ë®òÈå≤„Åô„Çã„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
            }
            
            body.innerHTML = html;
            modal.classList.add('active');
            
            // „É™„Éû„Ç§„É≥„ÉÄ„Éº„Éê„Éä„Éº„ÇíÈùûË°®Á§∫
            document.getElementById('reminderBanner').classList.remove('show');
        }

        // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥„ÅÆÂàá„ÇäÊõø„Åà
        function toggleMilestone(projectId, milestoneIndex, achieved) {
            const tempKey = `milestone_${projectId}_${milestoneIndex}`;
            sessionStorage.setItem(tempKey, achieved ? 'true' : 'false');
            
            // UI„ÅÆÊõ¥Êñ∞
            const label = document.querySelector(`label[for="milestone_${project.id}_${milestoneIndex}"]`);
            if (label) {
                if (achieved) {
                    label.classList.add('milestone-achieved');
                } else {
                    label.classList.remove('milestone-achieved');
                }
            }
        }

        // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥„ÅåÈÅîÊàê„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
        function isMilestoneAchieved(projectId, milestoneIndex) {
            const latestLog = app.logs
                .filter(log => 
                    log.projectId === projectId && 
                    log.type === 'milestone' &&
                    log.milestoneIndex === milestoneIndex
                )
                .sort((a, b) => new Date(b.date) - new Date(a.date))[0];
            
            return latestLog && latestLog.achieved;
        }

        // ‰ªäÊó•„ÅÆÊîπÂñÑÁÇπ„ÇíÂèñÂæó
        function getTodayImprovements() {
            const today = new Date().toDateString();
            const todayImprovement = app.improvements?.find(imp => 
                new Date(imp.date).toDateString() === today
            );
            return todayImprovement?.content || '';
        }
        
        // Êó•Ê¨°„É≠„Ç∞„ÅÆ‰øùÂ≠ò
        function saveDailyLog() {
            const today = new Date();
            
            // ÊîπÂñÑÁÇπ„ÉªÈÅ©Âøú‰∫ãÈ†Ö„Çí‰øùÂ≠ò
            const improvementsText = document.getElementById('dailyImprovements')?.value;
            if (improvementsText && improvementsText.trim()) {
                if (!app.improvements) {
                    app.improvements = [];
                }
                
                const todayIndex = app.improvements.findIndex(imp => 
                    new Date(imp.date).toDateString() === today.toDateString()
                );
                
                const improvement = {
                    id: todayIndex >= 0 ? app.improvements[todayIndex].id : Date.now().toString(),
                    date: today.toISOString(),
                    content: improvementsText.trim()
                };
                
                if (todayIndex >= 0) {
                    app.improvements[todayIndex] = improvement;
                } else {
                    app.improvements.push(improvement);
                }
                
                localStorage.setItem('pdca_improvements', JSON.stringify(app.improvements));
            }
            
            // ÊØéÊó•„ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÂá¶ÁêÜ
            const dailyProjects = app.currentProjectId 
                ? app.projects.filter(p => p.id === app.currentProjectId && p.trackingType === 'daily')
                : app.projects.filter(p => p.phase === 'Check' && p.trackingType === 'daily' && !p.completed && !p.deleted);
            
            dailyProjects.forEach(project => {
                const checkpoints = {};
                let hasChecked = false;
                
                project.checkpoints.forEach((_, index) => {
                    const checkbox = document.getElementById(`check_${project.id}_${index}`);
                    if (checkbox) {
                        checkpoints[index] = checkbox.checked;
                        if (checkbox.checked) hasChecked = true;
                    }
                });
                
                if (hasChecked) {
                    // ‰ªäÊó•„ÅÆ„É≠„Ç∞„Åå„ÅÇ„Çã„ÅãÁ¢∫Ë™ç
                    const existingLogIndex = app.logs.findIndex(log => 
                        log.projectId === project.id && 
                        new Date(log.date).toDateString() === today.toDateString()
                    );
                    
                    const log = {
                        id: existingLogIndex >= 0 ? app.logs[existingLogIndex].id : Date.now().toString(),
                        projectId: project.id,
                        date: today.toISOString(),
                        checkpoints: checkpoints,
                        completed: Object.values(checkpoints).every(v => v === true)
                    };
                    
                    if (existingLogIndex >= 0) {
                        app.logs[existingLogIndex] = log;
                    } else {
                        app.logs.push(log);
                    }
                }
            });
            
            // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥„ÅÆÂá¶ÁêÜ
            const milestoneProjects = app.currentProjectId 
                ? app.projects.filter(p => p.id === app.currentProjectId && p.trackingType === 'milestone')
                : app.projects.filter(p => p.phase === 'Check' && p.trackingType === 'milestone' && !p.completed && !p.deleted);
            
            milestoneProjects.forEach(project => {
                project.milestones.forEach((_, index) => {
                    const tempKey = `milestone_${project.id}_${index}`;
                    const tempValue = sessionStorage.getItem(tempKey);
                    
                    if (tempValue !== null) {
                        const achieved = tempValue === 'true';
                        const existingAchieved = isMilestoneAchieved(project.id, index);
                        
                        if (achieved !== existingAchieved) {
                            const log = {
                                id: Date.now().toString() + '_' + index,
                                projectId: project.id,
                                date: today.toISOString(),
                                type: 'milestone',
                                milestoneIndex: index,
                                achieved: achieved
                            };
                            app.logs.push(log);
                        }
                        
                        sessionStorage.removeItem(tempKey);
                    }
                });
            });
            
            // ÊúÄÁµÇ„ÉÅ„Çß„ÉÉ„ÇØÊó•„ÇíÊõ¥Êñ∞
            localStorage.setItem(STORAGE_KEYS.LAST_CHECK_DATE, today.toDateString());
            
            saveData();
            closeModal('logModal');
            renderDashboard();
            
            showToast('Ë®òÈå≤„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü', 'success');
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈÄ≤Êçó„ÅÆË®àÁÆó
        function calculateProjectProgress(project) {
            if (project.trackingType === 'daily') {
                const logs = app.logs.filter(log => log.projectId === project.id);
                const completedDays = logs.filter(log => log.completed).length;
                return Math.round((completedDays / project.duration) * 100);
            } else if (project.trackingType === 'count') {
                // „Ç´„Ç¶„É≥„ÉàÂûã„ÅÆÈÄ≤ÊçóÔºà‰ªÆÔºö100Âõû„ÇíÁõÆÊ®ô„Å®„Åó„Å¶Ë®àÁÆóÔºâ
                const totalCount = project.countItems.reduce((sum, _, index) => {
                    return sum + getProjectCountForItem(project.id, index);
                }, 0);
                const targetCount = project.countItems.length * 100; // ÂêÑÈ†ÖÁõÆ100Âõû„ÇíÁõÆÊ®ô
                return Math.min(100, Math.round((totalCount / targetCount) * 100));
            } else if (project.trackingType === 'milestone') {
                const achieved = getMilestoneAchievedCount(project);
                const total = project.milestones.length;
                return Math.round((achieved / total) * 100);
            }
            return 0;
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÊÆã„ÇäÊó•Êï∞„ÇíÂèñÂæó
        function getProjectDaysLeft(project) {
            const startDate = new Date(project.startDate);
            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + project.duration);
            
            const today = new Date();
            const daysLeft = Math.ceil((endDate - today) / (1000 * 60 * 60 * 24));
            
            return Math.max(0, daysLeft);
        }

        // „Éï„Çß„Éº„Ç∫„ÅÆË™¨Êòé„ÇíÂèñÂæó
        function getPhaseDescription(phase) {
            const descriptions = {
                'Play': '„Ç¢„Ç§„Éá„Ç¢„ÇíËá™Áî±„Å´ËÄÉ„Åà„ÄÅÂèØËÉΩÊÄß„ÇíÊé¢„ÇãÊÆµÈöé',
                'Design': '„Ç¢„Ç§„Éá„Ç¢„ÇíÂÖ∑‰ΩìÁöÑ„Å™Ë®àÁîª„Å´ËêΩ„Å®„ÅóËæº„ÇÄÊÆµÈöé',
                'Check': 'Ë®àÁîª„ÇíÂÆüË°å„Åó„ÄÅÈÄ≤Êçó„ÇíÁ¢∫Ë™ç„Åô„ÇãÊÆµÈöé',
                'Adapt': 'ÁµêÊûú„ÇíË©ï‰æ°„Åó„ÄÅÊîπÂñÑÁÇπ„ÇíË¶ã„Å§„Åë„ÇãÊÆµÈöé'
            };
            return descriptions[phase] || '';
        }

        // „Éï„Çß„Éº„Ç∫ÁßªÂãï
        function moveToPhase(projectId, newPhase) {
            const project = app.projects.find(p => p.id === projectId);
            if (!project) return;
            
            project.phase = newPhase;
            saveData();
            renderDashboard();
            
            showToast(`${newPhase}„Éï„Çß„Éº„Ç∫„Å´ÁßªÂãï„Åó„Åæ„Åó„Åü`, 'success');
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÂÆå‰∫Ü
        function completeProject(projectId) {
            const project = app.projects.find(p => p.id === projectId);
            if (!project) return;
            
            if (confirm('„Åì„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂÆå‰∫Ü„Åó„Åæ„Åô„ÅãÔºü')) {
                project.completed = true;
                project.completedAt = new Date().toISOString();
                saveData();
                renderDashboard();
                
                showToast('„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ', 'success');
            }
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÂÜçÈñã
        function reactivateProject(event, projectId) {
            event.stopPropagation();
            
            const project = app.projects.find(p => p.id === projectId);
            if (!project) return;
            
            project.completed = false;
            project.phase = 'Design';
            delete project.completedAt;
            
            saveData();
            showSection('dashboard');
            
            showToast('„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÂÜçÈñã„Åó„Åæ„Åó„Åü', 'success');
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çµ„Ç§„ÇØ„É´„ÅÆÂÜçÈñã
        function restartProjectCycle(projectId) {
            const project = app.projects.find(p => p.id === projectId);
            if (!project) return;
            
            // „Çµ„Ç§„ÇØ„É´„Ç´„Ç¶„É≥„Éà„ÇíÂ¢ó„ÇÑ„Åô
            project.cycleCount = (project.cycleCount || 1) + 1;
            project.phase = 'Design';
            project.startDate = new Date().toISOString();
            
            saveData();
            renderDashboard();
            
            showToast('Êñ∞„Åó„ÅÑ„Çµ„Ç§„ÇØ„É´„ÇíÈñãÂßã„Åó„Åæ„Åó„Åü', 'success');
        }

        // ÈÄ±Ê¨°„É¨„Éù„Éº„Éà„ÅÆÊèèÁîª
        function renderWeeklyReport() {
            const reportDiv = document.getElementById('weeklyReport');
            const lastReport = localStorage.getItem('pdca_last_report');
            
            if (lastReport) {
                const report = JSON.parse(lastReport);
                reportDiv.innerHTML = `
                    <div class="analysis-card">
                        <div class="analysis-title">ÈÄ±Ê¨°„Ç§„É≥„Çµ„Ç§„Éà</div>
                        <div class="analysis-content">${report.content.replace(/\n/g, '<br>')}</div>
                        <div style="margin-top: 1rem; font-size: 0.875rem; opacity: 0.8;">
                            ÁîüÊàêÊó•: ${formatDate(new Date(report.date))}
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="generateWeeklyReport()">Êñ∞„Åó„ÅÑ„É¨„Éù„Éº„Éà„ÇíÁîüÊàê</button>
                    <button class="btn btn-secondary" style="margin-left: 0.5rem;" onclick="downloadReport()">
                        „É¨„Éù„Éº„Éà„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                    </button>
                `;
            }
        }

        // ÈÄ±Ê¨°„É¨„Éù„Éº„Éà„ÅÆÁîüÊàê
        async function generateWeeklyReport() {
            if (!app.apiKey) {
                alert('ÈÄ±Ê¨°„É¨„Éù„Éº„Éà„ÇíÁîüÊàê„Åô„Çã„Å´„ÅØ„ÄÅË®≠ÂÆö„Åã„ÇâOpenAI API„Ç≠„Éº„ÇíÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                showSettings();
                return;
            }
            
            const button = event.target;
            button.disabled = true;
            button.textContent = 'ÁîüÊàê‰∏≠...';
            
            try {
                // ÈÄ±Ê¨°„Éá„Éº„Çø„ÅÆÈõÜË®à
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                
                const weeklyLogs = app.logs.filter(log => 
                    new Date(log.date) >= weekAgo
                );
                
                const activeProjects = app.projects.filter(p => !p.completed && !p.deleted);
                
                // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åî„Å®„ÅÆÈÄ≤Êçó„Çµ„Éû„É™„Éº
                const projectSummaries = activeProjects.map(project => {
                    const projectLogs = weeklyLogs.filter(log => log.projectId === project.id);
                    const progress = calculateProjectProgress(project);
                    
                    return {
                        name: project.name,
                        phase: project.phase,
                        progress: progress,
                        logsCount: projectLogs.length,
                        trackingType: project.trackingType
                    };
                });
                
                // ‰ªäÈÄ±„ÅÆÊîπÂñÑÁÇπ„ÇíÂèñÂæó
                const weeklyImprovements = app.improvements.filter(imp => {
                    const impDate = new Date(imp.createdAt);
                    return impDate >= startOfWeek && impDate <= now;
                });

                // OpenAI API„Å∏„ÅÆ„É™„ÇØ„Ç®„Çπ„Éà
                const prompt = `
‰ª•‰∏ã„ÅÆPDCA„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÈÄ±Ê¨°ÈÄ≤Êçó„Éá„Éº„Çø„ÇíÂàÜÊûê„Åó„ÄÅÊó•Êú¨Ë™û„Åß„Ç§„É≥„Çµ„Ç§„Éà„Å®„Ç¢„Éâ„Éê„Ç§„Çπ„ÇíÊèê‰æõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö

${projectSummaries.map(p => `
- ${p.name} (${p.phase}„Éï„Çß„Éº„Ç∫)
  ÈÄ≤Êçó: ${p.progress}%
  ‰ªäÈÄ±„ÅÆË®òÈå≤: ${p.logsCount}Âõû
  „Çø„Ç§„Éó: ${p.trackingType}
`).join('\n')}

${weeklyImprovements.length > 0 ? `
‰ªäÈÄ±ÂÆüÊñΩ„Åó„ÅüÊîπÂñÑ„ÉªÈÅ©ÂøúÔºà${weeklyImprovements.length}‰ª∂Ôºâ:
${weeklyImprovements.map(imp => {
    const project = app.projects.find(p => p.id === imp.projectId);
    return `- ${project ? project.name : 'ÂÖ®Ëà¨'}: ${imp.content}`;
}).join('\n')}
` : ''}

‰ª•‰∏ã„ÅÆË¶≥ÁÇπ„ÅßÂàÜÊûê„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö
1. ÂÖ®‰ΩìÁöÑ„Å™ÈÄ≤ÊçóÁä∂Ê≥Å„ÅÆË©ï‰æ°
2. ${weeklyImprovements.length > 0 ? 'ÂÆüÊñΩ„Åó„ÅüÊîπÂñÑ„ÅÆÂäπÊûú„Å®‰ªäÂæå„ÅÆÂ±ïÈñã' : 'ÊúÄ„ÇÇÈ†ÜË™ø„Å™„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å®ÊîπÂñÑ„ÅåÂøÖË¶Å„Å™„Éó„É≠„Ç∏„Çß„ÇØ„Éà'}
3. Êù•ÈÄ±„Å´Âêë„Åë„Å¶„ÅÆÂÖ∑‰ΩìÁöÑ„Å™„Ç¢„Éâ„Éê„Ç§„Çπ
4. „É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥Á∂≠ÊåÅ„ÅÆ„Åü„ÇÅ„ÅÆÂä±„Åæ„Åó„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏
`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${app.apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'o3',
                        messages: [
                            { role: 'system', content: '„ÅÇ„Å™„Åü„ÅØÁîüÁî£ÊÄßÂêë‰∏ä„ÅÆÂ∞ÇÈñÄÂÆ∂„Åß„Åô„ÄÇPDCA„Çµ„Ç§„ÇØ„É´„Çí‰Ωø„Å£„ÅüËá™Â∑±ÊîπÂñÑ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÂàÜÊûê„Å®„Ç¢„Éâ„Éê„Ç§„Çπ„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ' },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.7,
                        max_tokens: 800
                    })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'API„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');
                }
                
                const data = await response.json();
                const report = {
                    date: new Date().toISOString(),
                    content: data.choices[0].message.content
                };
                
                // „É¨„Éù„Éº„Éà„Çí‰øùÂ≠ò
                localStorage.setItem('pdca_last_report', JSON.stringify(report));
                
                // „É¨„Éù„Éº„Éà„ÇíË°®Á§∫
                renderWeeklyReport();
                
                showToast('ÈÄ±Ê¨°„É¨„Éù„Éº„Éà„ÇíÁîüÊàê„Åó„Åæ„Åó„Åü', 'success');
                
            } catch (error) {
                console.error('„É¨„Éù„Éº„ÉàÁîüÊàê„Ç®„É©„Éº:', error);
                alert(`„É¨„Éù„Éº„Éà„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
            } finally {
                button.disabled = false;
                button.textContent = '„É¨„Éù„Éº„Éà„ÇíÁîüÊàê';
            }
        }

        // „Éá„Ç§„É™„Éº„Ç≥„É°„É≥„Éà„ÅÆÁîüÊàê
        async function generateDailyComment() {
            if (!app.apiKey) {
                alert('„Éá„Ç§„É™„Éº„Ç≥„É°„É≥„Éà„ÇíÁîüÊàê„Åô„Çã„Å´„ÅØ„ÄÅË®≠ÂÆö„Åã„ÇâOpenAI API„Ç≠„Éº„ÇíÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                showSettings();
                return;
            }
            
            const button = event.target;
            button.disabled = true;
            button.textContent = 'ÁîüÊàê‰∏≠...';
            
            try {
                // ‰ªäÊó•„ÅÆ„Éá„Éº„Çø„ÇíÂèñÂæó
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const todayLogs = app.logs.filter(log => {
                    const logDate = new Date(log.date);
                    logDate.setHours(0, 0, 0, 0);
                    return logDate.getTime() === today.getTime();
                });
                
                const activeProjects = app.projects.filter(p => !p.completed && !p.deleted);
                
                // Êú¨Êó•„ÅÆÊ¥ªÂãï„Çµ„Éû„É™„Éº
                const todaySummary = activeProjects.map(project => {
                    const projectLogs = todayLogs.filter(log => log.projectId === project.id);
                    return {
                        name: project.name,
                        phase: project.phase,
                        logsCount: projectLogs.length,
                        activities: projectLogs.map(log => log.content).join(', ')
                    };
                }).filter(p => p.logsCount > 0);

                // ‰ªäÊó•„ÅÆÊîπÂñÑÁÇπ„ÇíÂèñÂæó
                const todayImprovement = app.improvements?.find(imp => {
                    const impDate = new Date(imp.date);
                    impDate.setHours(0, 0, 0, 0);
                    return impDate.getTime() === today.getTime();
                });

                const prompt = `‰ª•‰∏ã„ÅØ‰ªäÊó•„ÅÆPDCA„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÊ¥ªÂãïË®òÈå≤„Åß„Åô„ÄÇ

${todaySummary.length > 0 ? 
`Êú¨Êó•„ÅÆÊ¥ªÂãï:
${todaySummary.map(p => `- ${p.name} (${p.phase}„Éï„Çß„Éº„Ç∫): ${p.activities}`).join('\n')}` :
'Êú¨Êó•„ÅØ„Åæ„Å†Ê¥ªÂãïË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ'}

${todayImprovement ? 
`Êú¨Êó•„ÅÆÊîπÂñÑÁÇπ„ÉªÈÅ©Âøú‰∫ãÈ†Ö:
${todayImprovement.content}` : ''}

„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å™„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊï∞: ${activeProjects.length}

‰ª•‰∏ã„ÅÆË¶≥ÁÇπ„Åã„Çâ„ÄÅÂä±„Åæ„Åó„Å®Âª∫Ë®≠ÁöÑ„Å™„Ç¢„Éâ„Éê„Ç§„Çπ„ÇíÂê´„ÇÄÁü≠„ÅÑ„Éá„Ç§„É™„Éº„Ç≥„É°„É≥„Éà„ÇíÊó•Êú¨Ë™û„ÅßÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà150ÊñáÂ≠óÁ®ãÂ∫¶Ôºâ:
1. Êú¨Êó•„ÅÆÊ¥ªÂãï„Å∏„ÅÆË©ï‰æ°
2. ${todayImprovement ? 'ÊîπÂñÑÁÇπ„ÅÆÂäπÊûú„Å´„Å§„ÅÑ„Å¶„ÅÆË©ï‰æ°' : 'ÊòéÊó•„Å´Âêë„Åë„Å¶„ÅÆÊîπÂñÑÊèêÊ°à'}
3. ÊòéÊó•„Å´Âêë„Åë„Å¶„ÅÆÂÖ∑‰ΩìÁöÑ„Å™„Ç¢„Éâ„Éê„Ç§„Çπ
4. „É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥„ÇíÈ´ò„ÇÅ„Çã‰∏ÄË®Ä`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${app.apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'o3',
                        messages: [
                            { role: 'system', content: '„ÅÇ„Å™„Åü„ÅØÂÑ™„Åó„Åè„Å¶Âä±„Åæ„Åó‰∏äÊâã„Å™„Ç≥„Éº„ÉÅ„Åß„Åô„ÄÇÁ∞°ÊΩî„ÅßÊ∏©„Åã„ÅÑ„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÈÄÅ„Çä„Åæ„Åô„ÄÇ' },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.8,
                        max_tokens: 200
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                const comment = data.choices[0].message.content;
                
                // „Ç≥„É°„É≥„Éà„Çí‰øùÂ≠ò
                const dailyComment = {
                    date: new Date().toISOString(),
                    content: comment
                };
                
                // ‰ªäÊó•„ÅÆ„Ç≥„É°„É≥„Éà„Çí‰øùÂ≠òÔºà1Êó•1„Å§Ôºâ
                const savedComments = JSON.parse(localStorage.getItem('pdca_daily_comments') || '[]');
                const todayIndex = savedComments.findIndex(c => {
                    const commentDate = new Date(c.date);
                    commentDate.setHours(0, 0, 0, 0);
                    return commentDate.getTime() === today.getTime();
                });
                
                if (todayIndex >= 0) {
                    savedComments[todayIndex] = dailyComment;
                } else {
                    savedComments.push(dailyComment);
                }
                
                localStorage.setItem('pdca_daily_comments', JSON.stringify(savedComments));
                
                // „Ç≥„É°„É≥„Éà„ÇíË°®Á§∫
                renderDailyComment();
                
                showToast('„Éá„Ç§„É™„Éº„Ç≥„É°„É≥„Éà„ÇíÁîüÊàê„Åó„Åæ„Åó„Åü', 'success');
                
            } catch (error) {
                console.error('„Ç≥„É°„É≥„ÉàÁîüÊàê„Ç®„É©„Éº:', error);
                alert(`„Ç≥„É°„É≥„Éà„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
            } finally {
                button.disabled = false;
                button.textContent = '‰ªäÊó•„ÅÆ„Ç≥„É°„É≥„Éà„ÇíÁîüÊàê';
            }
        }

        // „Éá„Ç§„É™„Éº„Ç≥„É°„É≥„Éà„ÅÆË°®Á§∫
        function renderDailyComment() {
            const dailyCommentDiv = document.getElementById('dailyComment');
            const savedComments = JSON.parse(localStorage.getItem('pdca_daily_comments') || '[]');
            
            if (savedComments.length === 0) {
                dailyCommentDiv.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üí¨</div>
                        <div class="empty-text">‰ªäÊó•„ÅÆ„Ç≥„É°„É≥„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                        <button class="btn btn-primary" onclick="generateDailyComment()">‰ªäÊó•„ÅÆ„Ç≥„É°„É≥„Éà„ÇíÁîüÊàê</button>
                    </div>
                `;
                return;
            }
            
            // ÊúÄÊñ∞„ÅÆ„Ç≥„É°„É≥„Éà„Åã„ÇâË°®Á§∫
            const sortedComments = savedComments.sort((a, b) => new Date(b.date) - new Date(a.date));
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            dailyCommentDiv.innerHTML = `
                <div style="margin-bottom: 1rem;">
                    <button class="btn btn-primary" onclick="generateDailyComment()">‰ªäÊó•„ÅÆ„Ç≥„É°„É≥„Éà„ÇíÁîüÊàê</button>
                </div>
                ${sortedComments.map(comment => {
                    const commentDate = new Date(comment.date);
                    const isToday = (() => {
                        const d = new Date(comment.date);
                        d.setHours(0, 0, 0, 0);
                        return d.getTime() === today.getTime();
                    })();
                    
                    return `
                        <div class="card" style="margin-bottom: 1rem; ${isToday ? 'border: 2px solid var(--primary);' : ''}">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                <div style="font-weight: bold; color: var(--text-secondary);">
                                    ${formatDate(commentDate)} ${isToday ? '(‰ªäÊó•)' : ''}
                                </div>
                            </div>
                            <div style="font-size: 1.1rem; line-height: 1.6;">
                                ${comment.content}
                            </div>
                        </div>
                    `;
                }).join('')}
            `;
        }

        // ÊúàÊ¨°„Ç§„É≥„Çµ„Ç§„Éà„ÅÆÁîüÊàê
        async function generateMonthlyInsight() {
            if (!app.apiKey) {
                alert('ÊúàÊ¨°„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê„Åô„Çã„Å´„ÅØ„ÄÅË®≠ÂÆö„Åã„ÇâOpenAI API„Ç≠„Éº„ÇíÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                showSettings();
                return;
            }
            
            const button = event.target;
            button.disabled = true;
            button.textContent = 'ÁîüÊàê‰∏≠...';
            
            try {
                // ‰ªäÊúà„ÅÆ„Éá„Éº„Çø„ÇíÂèñÂæó
                const now = new Date();
                const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
                
                const monthlyLogs = app.logs.filter(log => 
                    new Date(log.date) >= monthStart
                );
                
                const monthlyProjects = app.projects.filter(p => 
                    new Date(p.createdAt) >= monthStart || monthlyLogs.some(log => log.projectId === p.id)
                );
                
                // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åî„Å®„ÅÆÁµ±Ë®à
                const projectStats = monthlyProjects.map(project => {
                    const projectLogs = monthlyLogs.filter(log => log.projectId === project.id);
                    const progress = calculateProjectProgress(project);
                    
                    return {
                        name: project.name,
                        phase: project.phase,
                        progress: progress,
                        logsCount: projectLogs.length,
                        completed: project.completed,
                        createdThisMonth: new Date(project.createdAt) >= monthStart
                    };
                });

                const completedCount = projectStats.filter(p => p.completed).length;
                const activeCount = projectStats.filter(p => !p.completed).length;
                const totalLogs = monthlyLogs.length;
                
                // ‰ªäÊúà„ÅÆÊîπÂñÑÁÇπ„ÇíÂèñÂæó
                const monthlyImprovements = app.improvements?.filter(imp => 
                    new Date(imp.date) >= monthStart
                ) || [];

                const prompt = `‰ª•‰∏ã„ÅØ‰ªäÊúà„ÅÆPDCA„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÁµ±Ë®à„Éá„Éº„Çø„Åß„Åô„ÄÇ

‰ªäÊúà„ÅÆÊ¥ªÂãï:
- Á∑è„É≠„Ç∞Êï∞: ${totalLogs}
- „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„Ç∏„Çß„ÇØ„Éà: ${activeCount}
- ÂÆå‰∫Ü„Éó„É≠„Ç∏„Çß„ÇØ„Éà: ${completedCount}
- Êñ∞Ë¶èÈñãÂßã„Éó„É≠„Ç∏„Çß„ÇØ„Éà: ${projectStats.filter(p => p.createdThisMonth).length}

„Éó„É≠„Ç∏„Çß„ÇØ„ÉàË©≥Á¥∞:
${projectStats.map(p => `- ${p.name} (${p.phase}„Éï„Çß„Éº„Ç∫): „É≠„Ç∞Êï∞${p.logsCount}Âõû, ÈÄ≤Êçó${p.progress}%${p.completed ? ' [ÂÆå‰∫Ü]' : ''}`).join('\n')}

${monthlyImprovements.length > 0 ? 
`‰ªäÊúàÂÆüÊñΩ„Åó„ÅüÊîπÂñÑÁÇπ„ÉªÈÅ©Âøú‰∫ãÈ†Ö (${monthlyImprovements.length}‰ª∂):
${monthlyImprovements.slice(-5).map(imp => `- ${new Date(imp.date).getDate()}Êó•: ${imp.content}`).join('\n')}` : ''}

‰ª•‰∏ã„ÅÆË¶≥ÁÇπ„Åã„Çâ„ÄÅ‰ªäÊúà„ÅÆÊåØ„ÇäËøî„Çä„Å®Êù•Êúà„Å∏„ÅÆÊà¶Áï•ÁöÑ„Ç¢„Éâ„Éê„Ç§„Çπ„ÇíÂê´„ÇÄÊúàÊ¨°„Ç§„É≥„Çµ„Ç§„Éà„ÇíÊó•Êú¨Ë™û„ÅßÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà300ÊñáÂ≠óÁ®ãÂ∫¶Ôºâ:
1. ‰ªäÊúà„ÅÆÊàêÊûú„Å®ÊîπÂñÑÁÇπ„ÅÆÂàÜÊûê
2. ${monthlyImprovements.length > 0 ? 'ÂÆüÊñΩ„Åó„ÅüÊîπÂñÑ„ÉªÈÅ©Âøú„ÅÆÂäπÊûúË©ï‰æ°' : 'PDCA„Çµ„Ç§„ÇØ„É´„ÅÆÂÆüÊñΩÁä∂Ê≥Å„ÅÆË©ï‰æ°'}
3. Êù•Êúà„ÅÆÈáçÁÇπË™≤È°å„ÅÆÊèêÊ°à
4. ÁîüÁî£ÊÄßÂêë‰∏ä„ÅÆ„Åü„ÇÅ„ÅÆÂÖ∑‰ΩìÁöÑ„Å™„Ç¢„Éâ„Éê„Ç§„Çπ`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${app.apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'o3',
                        messages: [
                            { role: 'system', content: '„ÅÇ„Å™„Åü„ÅØÁîüÁî£ÊÄßÂêë‰∏ä„ÅÆÂ∞ÇÈñÄÂÆ∂„Åß„Åô„ÄÇPDCA„Çµ„Ç§„ÇØ„É´„Çí‰Ωø„Å£„ÅüËá™Â∑±ÊîπÂñÑ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÊúàÊ¨°ÂàÜÊûê„Å®Êà¶Áï•ÁöÑ„Ç¢„Éâ„Éê„Ç§„Çπ„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ' },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.7,
                        max_tokens: 400
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                const insight = data.choices[0].message.content;
                
                // „Ç§„É≥„Çµ„Ç§„Éà„Çí‰øùÂ≠ò
                const monthlyInsight = {
                    date: new Date().toISOString(),
                    month: `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`,
                    content: insight,
                    stats: {
                        totalLogs,
                        activeCount,
                        completedCount
                    }
                };
                
                const savedInsights = JSON.parse(localStorage.getItem('pdca_monthly_insights') || '[]');
                const existingIndex = savedInsights.findIndex(i => i.month === monthlyInsight.month);
                
                if (existingIndex >= 0) {
                    savedInsights[existingIndex] = monthlyInsight;
                } else {
                    savedInsights.push(monthlyInsight);
                }
                
                localStorage.setItem('pdca_monthly_insights', JSON.stringify(savedInsights));
                
                // „Ç§„É≥„Çµ„Ç§„Éà„ÇíË°®Á§∫
                renderMonthlyInsight();
                
                showToast('ÊúàÊ¨°„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê„Åó„Åæ„Åó„Åü', 'success');
                
            } catch (error) {
                console.error('„Ç§„É≥„Çµ„Ç§„ÉàÁîüÊàê„Ç®„É©„Éº:', error);
                alert(`„Ç§„É≥„Çµ„Ç§„Éà„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
            } finally {
                button.disabled = false;
                button.textContent = '‰ªäÊúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê';
            }
        }

        // ÊúàÊ¨°„Ç§„É≥„Çµ„Ç§„Éà„ÅÆË°®Á§∫
        function renderMonthlyInsight() {
            const monthlyInsightDiv = document.getElementById('monthlyInsight');
            const savedInsights = JSON.parse(localStorage.getItem('pdca_monthly_insights') || '[]');
            
            if (savedInsights.length === 0) {
                monthlyInsightDiv.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìà</div>
                        <div class="empty-text">‰ªäÊúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                        <button class="btn btn-primary" onclick="generateMonthlyInsight()">‰ªäÊúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê</button>
                    </div>
                `;
                return;
            }
            
            const sortedInsights = savedInsights.sort((a, b) => new Date(b.date) - new Date(a.date));
            const currentMonth = `${new Date().getFullYear()}-${String(new Date().getMonth() + 1).padStart(2, '0')}`;
            
            monthlyInsightDiv.innerHTML = `
                <div style="margin-bottom: 1rem;">
                    <button class="btn btn-primary" onclick="generateMonthlyInsight()">‰ªäÊúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê</button>
                </div>
                ${sortedInsights.map(insight => {
                    const isCurrentMonth = insight.month === currentMonth;
                    const [year, month] = insight.month.split('-');
                    
                    return `
                        <div class="card" style="margin-bottom: 1rem; ${isCurrentMonth ? 'border: 2px solid var(--primary);' : ''}">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <div style="font-weight: bold; font-size: 1.2rem;">
                                    ${year}Âπ¥${parseInt(month)}Êúà ${isCurrentMonth ? '(‰ªäÊúà)' : ''}
                                </div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">
                                    „É≠„Ç∞: ${insight.stats.totalLogs} | „Ç¢„ÇØ„ÉÜ„Ç£„Éñ: ${insight.stats.activeCount} | ÂÆå‰∫Ü: ${insight.stats.completedCount}
                                </div>
                            </div>
                            <div style="font-size: 1.1rem; line-height: 1.8; white-space: pre-wrap;">
                                ${insight.content}
                            </div>
                        </div>
                    `;
                }).join('')}
            `;
        }

        // 3„É∂Êúà„Ç§„É≥„Çµ„Ç§„Éà„ÅÆÁîüÊàê
        async function generateQuarterlyInsight() {
            if (!app.apiKey) {
                alert('3„É∂Êúà„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê„Åô„Çã„Å´„ÅØ„ÄÅË®≠ÂÆö„Åã„ÇâOpenAI API„Ç≠„Éº„ÇíÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                showSettings();
                return;
            }
            
            const button = event.target;
            button.disabled = true;
            button.textContent = 'ÁîüÊàê‰∏≠...';
            
            try {
                // 3„É∂ÊúàÂâç„Åã„Çâ„ÅÆ„Éá„Éº„Çø„ÇíÂèñÂæó
                const now = new Date();
                const threeMonthsAgo = new Date(now.getFullYear(), now.getMonth() - 2, 1);
                
                const quarterlyLogs = app.logs.filter(log => 
                    new Date(log.date) >= threeMonthsAgo
                );
                
                const quarterlyProjects = app.projects.filter(p => 
                    new Date(p.createdAt) >= threeMonthsAgo || quarterlyLogs.some(log => log.projectId === p.id)
                );
                
                // Êúà„Åî„Å®„ÅÆÁµ±Ë®à
                const monthlyStats = [];
                for (let i = 2; i >= 0; i--) {
                    const monthDate = new Date(now.getFullYear(), now.getMonth() - i, 1);
                    const nextMonth = new Date(now.getFullYear(), now.getMonth() - i + 1, 1);
                    
                    const monthLogs = quarterlyLogs.filter(log => {
                        const logDate = new Date(log.date);
                        return logDate >= monthDate && logDate < nextMonth;
                    });
                    
                    monthlyStats.push({
                        month: `${monthDate.getFullYear()}Âπ¥${monthDate.getMonth() + 1}Êúà`,
                        logsCount: monthLogs.length,
                        activeProjects: new Set(monthLogs.map(log => log.projectId)).size
                    });
                }
                
                // „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÊàêÈï∑ÂàÜÊûê
                const projectGrowth = quarterlyProjects.map(project => {
                    const projectLogs = quarterlyLogs.filter(log => log.projectId === project.id);
                    const firstLog = projectLogs.sort((a, b) => new Date(a.date) - new Date(b.date))[0];
                    const lastLog = projectLogs.sort((a, b) => new Date(b.date) - new Date(a.date))[0];
                    
                    return {
                        name: project.name,
                        totalLogs: projectLogs.length,
                        durationDays: firstLog && lastLog ? 
                            Math.ceil((new Date(lastLog.date) - new Date(firstLog.date)) / (1000 * 60 * 60 * 24)) : 0,
                        completed: project.completed,
                        phase: project.phase
                    };
                });

                const completedCount = projectGrowth.filter(p => p.completed).length;
                const totalProjects = quarterlyProjects.length;
                const completionRate = totalProjects > 0 ? Math.round((completedCount / totalProjects) * 100) : 0;
                
                // 3„É∂ÊúàÈñì„ÅÆÊîπÂñÑÁÇπ„ÇíÂèñÂæó
                const quarterlyImprovements = app.improvements?.filter(imp => 
                    new Date(imp.date) >= threeMonthsAgo
                ) || [];

                const prompt = `‰ª•‰∏ã„ÅØÈÅéÂéª3„É∂Êúà„ÅÆPDCA„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÁµ±Ë®à„Éá„Éº„Çø„Åß„Åô„ÄÇ

ÊúàÂà•Ê¥ªÂãïÊé®Áßª:
${monthlyStats.map(s => `- ${s.month}: „É≠„Ç∞Êï∞${s.logsCount}Âõû, „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„Ç∏„Çß„ÇØ„Éà${s.activeProjects}ÂÄã`).join('\n')}

„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂàÜÊûê:
- Á∑è„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊï∞: ${totalProjects}
- ÂÆå‰∫Ü„Éó„É≠„Ç∏„Çß„ÇØ„Éà: ${completedCount} (ÂÆå‰∫ÜÁéá: ${completionRate}%)
- Á∑è„É≠„Ç∞Êï∞: ${quarterlyLogs.length}

‰∏ªË¶Å„Éó„É≠„Ç∏„Çß„ÇØ„Éà:
${projectGrowth.slice(0, 5).map(p => `- ${p.name}: ${p.totalLogs}„É≠„Ç∞, ${p.durationDays}Êó•Èñì${p.completed ? ' [ÂÆå‰∫Ü]' : ` [${p.phase}]`}`).join('\n')}

${quarterlyImprovements.length > 0 ? 
`3„É∂ÊúàÈñì„ÅÆ‰∏ª„Å™ÊîπÂñÑ„ÉªÈÅ©Âøú (${quarterlyImprovements.length}‰ª∂ÂÆüÊñΩ):
${quarterlyImprovements.slice(-10).map(imp => {
    const date = new Date(imp.date);
    return `- ${date.getMonth() + 1}/${date.getDate()}: ${imp.content}`;
}).join('\n')}` : ''}

‰ª•‰∏ã„ÅÆË¶≥ÁÇπ„Åã„Çâ„ÄÅ3„É∂ÊúàÈñì„ÅÆÊàêÈï∑ÂàÜÊûê„Å®‰ªäÂæå„ÅÆÊà¶Áï•„ÇíÂê´„ÇÄÁ∑èÂêà„Ç§„É≥„Çµ„Ç§„Éà„ÇíÊó•Êú¨Ë™û„ÅßÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà400ÊñáÂ≠óÁ®ãÂ∫¶Ôºâ:
1. 3„É∂ÊúàÈñì„ÅÆÊàêÈï∑„Éà„É¨„É≥„Éâ„Å®ÈÅîÊàêÂ∫¶„ÅÆË©ï‰æ°
2. ${quarterlyImprovements.length > 0 ? 'ÂÆüÊñΩ„Åó„ÅüÊîπÂñÑ„ÉªÈÅ©Âøú„ÅÆÁ¥ØÁ©çÂäπÊûú' : 'PDCA„Çµ„Ç§„ÇØ„É´„ÅÆÁøíÊÖ£Âåñ„ÅÆÂ∫¶Âêà„ÅÑ'}
3. ÊàêÂäü„Éë„Çø„Éº„É≥„Å®ÊîπÂñÑ„ÅåÂøÖË¶Å„Å™„Éë„Çø„Éº„É≥„ÅÆÁâπÂÆö
4. Ê¨°„ÅÆ3„É∂Êúà„Å´Âêë„Åë„ÅüÊà¶Áï•ÁöÑÊèêË®Ä
5. Èï∑ÊúüÁöÑ„Å™ÊàêÈï∑„ÅÆ„Åü„ÇÅ„ÅÆÂÖ∑‰ΩìÁöÑ„Ç¢„ÇØ„Ç∑„Éß„É≥`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${app.apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'o3',
                        messages: [
                            { role: 'system', content: '„ÅÇ„Å™„Åü„ÅØÊàêÈï∑Êà¶Áï•„ÅÆÂ∞ÇÈñÄÂÆ∂„Åß„Åô„ÄÇPDCA„Çµ„Ç§„ÇØ„É´„Çí‰Ωø„Å£„ÅüÈï∑ÊúüÁöÑ„Å™Ëá™Â∑±ÊîπÂñÑ„ÅÆÂàÜÊûê„Å®Êà¶Áï•Á´ãÊ°à„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ' },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.7,
                        max_tokens: 500
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                const insight = data.choices[0].message.content;
                
                // „Ç§„É≥„Çµ„Ç§„Éà„Çí‰øùÂ≠ò
                const quarterlyInsight = {
                    date: new Date().toISOString(),
                    quarter: `${now.getFullYear()}-Q${Math.ceil((now.getMonth() + 1) / 3)}`,
                    content: insight,
                    stats: {
                        totalProjects,
                        completedCount,
                        completionRate,
                        totalLogs: quarterlyLogs.length
                    }
                };
                
                const savedInsights = JSON.parse(localStorage.getItem('pdca_quarterly_insights') || '[]');
                savedInsights.push(quarterlyInsight);
                
                // ÊúÄÊñ∞„ÅÆ10‰ª∂„ÅÆ„Åø‰øùÊåÅ
                if (savedInsights.length > 10) {
                    savedInsights.shift();
                }
                
                localStorage.setItem('pdca_quarterly_insights', JSON.stringify(savedInsights));
                
                // „Ç§„É≥„Çµ„Ç§„Éà„ÇíË°®Á§∫
                renderQuarterlyInsight();
                
                showToast('3„É∂Êúà„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê„Åó„Åæ„Åó„Åü', 'success');
                
            } catch (error) {
                console.error('„Ç§„É≥„Çµ„Ç§„ÉàÁîüÊàê„Ç®„É©„Éº:', error);
                alert(`„Ç§„É≥„Çµ„Ç§„Éà„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
            } finally {
                button.disabled = false;
                button.textContent = '3„É∂Êúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê';
            }
        }

        // 3„É∂Êúà„Ç§„É≥„Çµ„Ç§„Éà„ÅÆË°®Á§∫
        function renderQuarterlyInsight() {
            const quarterlyInsightDiv = document.getElementById('quarterlyInsight');
            const savedInsights = JSON.parse(localStorage.getItem('pdca_quarterly_insights') || '[]');
            
            if (savedInsights.length === 0) {
                quarterlyInsightDiv.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üéØ</div>
                        <div class="empty-text">3„É∂Êúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                        <button class="btn btn-primary" onclick="generateQuarterlyInsight()">3„É∂Êúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê</button>
                    </div>
                `;
                return;
            }
            
            const sortedInsights = savedInsights.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            quarterlyInsightDiv.innerHTML = `
                <div style="margin-bottom: 1rem;">
                    <button class="btn btn-primary" onclick="generateQuarterlyInsight()">3„É∂Êúà„ÅÆ„Ç§„É≥„Çµ„Ç§„Éà„ÇíÁîüÊàê</button>
                </div>
                ${sortedInsights.map((insight, index) => {
                    const date = new Date(insight.date);
                    
                    return `
                        <div class="card" style="margin-bottom: 1rem; ${index === 0 ? 'border: 2px solid var(--primary);' : ''}">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <div style="font-weight: bold; font-size: 1.2rem;">
                                    ${formatDate(date)} ÁîüÊàê ${index === 0 ? '(ÊúÄÊñ∞)' : ''}
                                </div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">
                                    „Éó„É≠„Ç∏„Çß„ÇØ„Éà: ${insight.stats.totalProjects} | ÂÆå‰∫Ü: ${insight.stats.completedCount} (${insight.stats.completionRate}%) | „É≠„Ç∞: ${insight.stats.totalLogs}
                                </div>
                            </div>
                            <div style="font-size: 1.1rem; line-height: 1.8; white-space: pre-wrap;">
                                ${insight.content}
                            </div>
                        </div>
                    `;
                }).join('')}
            `;
        }

        // „É¨„Éù„Éº„Éà„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
        function downloadReport() {
            const lastReport = localStorage.getItem('pdca_last_report');
            if (!lastReport) return;
            
            const report = JSON.parse(lastReport);
            const content = `PDCA Mosaic ÈÄ±Ê¨°„É¨„Éù„Éº„Éà\nÁîüÊàêÊó•: ${formatDate(new Date(report.date))}\n\n${report.content}`;
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `weekly-report-${formatDate(new Date(), 'file')}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ÊØéÊó•„ÅÆ„É™„Éû„Ç§„É≥„ÉÄ„Éº„ÉÅ„Çß„ÉÉ„ÇØ
        function checkDailyReminder() {
            const today = new Date().toDateString();
            const lastCheckDate = localStorage.getItem(STORAGE_KEYS.LAST_CHECK_DATE);
            
            // ‰ªäÊó•„Åæ„Å†„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà
            if (lastCheckDate !== today) {
                const hasActiveProjects = app.projects.some(p => 
                    p.phase === 'Check' && p.trackingType === 'daily' && !p.completed && !p.deleted
                );
                
                if (hasActiveProjects) {
                    // Êú™ÂÆå‰∫Ü„ÅÆ„Çø„Çπ„ÇØ„Åå„ÅÇ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                    const todayLogs = app.logs.filter(log => 
                        new Date(log.date).toDateString() === today
                    );
                    
                    const hasUncompletedTasks = app.projects.some(project => {
                        if (project.phase !== 'Check' || project.trackingType !== 'daily' || project.completed || project.deleted) return false;
                        
                        const todayLog = todayLogs.find(log => log.projectId === project.id);
                        return !todayLog || !todayLog.completed;
                    });
                    
                    if (hasUncompletedTasks) {
                        document.getElementById('reminderBanner').classList.add('show');
                        
                        // „Éñ„É©„Ç¶„Ç∂ÈÄöÁü•„ÇíÈÄÅ‰ø°
                        if (localStorage.getItem(STORAGE_KEYS.NOTIFICATION_SETTINGS) === 'enabled') {
                            sendNotification();
                        }
                    }
                }
            }
        }

        // ÈÄöÁü•Ê®©Èôê„ÅÆ„É™„ÇØ„Ç®„Çπ„Éà
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        // „Éñ„É©„Ç¶„Ç∂ÈÄöÁü•„ÅÆÈÄÅ‰ø°
        function sendNotification() {
            if ('Notification' in window && Notification.permission === 'granted') {
                const notification = new Notification('PDCA Mosaic - ‰ªäÊó•„ÅÆ„Çø„Çπ„ÇØ', {
                    body: '‰ªäÊó•„ÅÆ„Çø„Çπ„ÇØ„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åó„Çá„ÅÜÔºÅ',
                    icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="%236366f1"/><text x="50" y="65" font-size="50" text-anchor="middle" fill="white">‚óà</text></svg>',
                    badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="%236366f1"/></svg>',
                    requireInteraction: true
                });
                
                notification.onclick = function() {
                    window.focus();
                    showDailyLog();
                    notification.close();
                };
            }
        }

        // ÈÄöÁü•Ë®≠ÂÆö„ÅÆÂàá„ÇäÊõø„Åà
        function toggleNotifications() {
            const currentStatus = localStorage.getItem(STORAGE_KEYS.NOTIFICATION_SETTINGS);
            const newStatus = currentStatus === 'enabled' ? 'disabled' : 'enabled';
            
            if (newStatus === 'enabled' && 'Notification' in window) {
                if (Notification.permission === 'default') {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            localStorage.setItem(STORAGE_KEYS.NOTIFICATION_SETTINGS, 'enabled');
                            updateNotificationStatus();
                        }
                    });
                } else if (Notification.permission === 'granted') {
                    localStorage.setItem(STORAGE_KEYS.NOTIFICATION_SETTINGS, 'enabled');
                    updateNotificationStatus();
                } else {
                    alert('„Éñ„É©„Ç¶„Ç∂„ÅÆË®≠ÂÆö„ÅßÈÄöÁü•„ÇíË®±ÂèØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                }
            } else {
                localStorage.setItem(STORAGE_KEYS.NOTIFICATION_SETTINGS, 'disabled');
                updateNotificationStatus();
            }
        }

        // ÈÄöÁü•„Çπ„ÉÜ„Éº„Çø„Çπ„ÅÆË°®Á§∫Êõ¥Êñ∞
        function updateNotificationStatus() {
            const status = localStorage.getItem(STORAGE_KEYS.NOTIFICATION_SETTINGS);
            const statusElement = document.getElementById('notificationStatus');
            if (statusElement) {
                statusElement.textContent = status === 'enabled' ? 'ÈÄöÁü•„Åå„Ç™„É≥„Åß„Åô' : 'ÈÄöÁü•„Çí„Ç™„É≥„Å´„Åô„Çã';
            }
        }

        // API„Ç≠„Éº„ÅÆ‰øùÂ≠ò
        function saveAPIKey() {
            const apiKey = document.getElementById('apiKey').value.trim();
            
            if (!apiKey) {
                alert('API„Ç≠„Éº„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            app.apiKey = apiKey;
            localStorage.setItem(STORAGE_KEYS.API_KEY, apiKey);
            
            closeModal('apiKeyModal');
            showToast('API„Ç≠„Éº„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü', 'success');
        }

        // „Éá„Éº„Çø„ÅÆ„Ç®„ÇØ„Çπ„Éù„Éº„Éà
        function exportData() {
            const data = {
                ideas: app.ideas,
                projects: app.projects,
                logs: app.logs,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pdca-mosaic-backup-${formatDate(new Date(), 'file')}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('„Éá„Éº„Çø„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Åó„Åæ„Åó„Åü', 'success');
        }

        // „Éá„Éº„Çø„ÅÆ„Ç§„É≥„Éù„Éº„Éà
        function importData() {
            document.getElementById('importFile').click();
        }

        // „Ç§„É≥„Éù„Éº„Éà„Éè„É≥„Éâ„É©„Éº
        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (!data.ideas || !data.projects || !data.logs) {
                        throw new Error('ÁÑ°Âäπ„Å™„Éá„Éº„ÇøÂΩ¢Âºè„Åß„Åô');
                    }
                    
                    if (confirm('ÁèæÂú®„ÅÆ„Éá„Éº„Çø„ÅØ‰∏äÊõ∏„Åç„Åï„Çå„Åæ„Åô„ÄÇ„Ç§„É≥„Éù„Éº„Éà„ÇíÁ∂öË°å„Åó„Åæ„Åô„ÅãÔºü')) {
                        app.ideas = data.ideas;
                        app.projects = data.projects;
                        app.logs = data.logs;
                        
                        saveData();
                        renderDashboard();
                        
                        showToast('„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà„Åó„Åæ„Åó„Åü', 'success');
                    }
                } catch (error) {
                    alert('„Éá„Éº„Çø„ÅÆ„Ç§„É≥„Éù„Éº„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                }
            };
            
            reader.readAsText(file);
            event.target.value = '';
        }

        // „Ç´„É¨„É≥„ÉÄ„ÉºÈñ¢ÈÄ£„ÅÆÁä∂ÊÖã
        const calendarState = {
            currentYear: new Date().getFullYear(),
            currentMonth: new Date().getMonth(),
            selectedDate: null
        };

        // „Ç´„É¨„É≥„ÉÄ„Éº„ÅÆÊèèÁîª
        function renderCalendar() {
            const year = calendarState.currentYear;
            const month = calendarState.currentMonth;
            
            // „Çø„Ç§„Éà„É´„ÅÆÊõ¥Êñ∞
            document.getElementById('calendarTitle').textContent = `${year}Âπ¥${month + 1}Êúà`;
            
            // „Ç´„É¨„É≥„ÉÄ„Éº„Ç∞„É™„ÉÉ„Éâ„ÅÆÁîüÊàê
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            // ÊõúÊó•„Éò„ÉÉ„ÉÄ„Éº
            const weekdays = ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'];
            weekdays.forEach(day => {
                const weekdayDiv = document.createElement('div');
                weekdayDiv.className = 'calendar-weekday';
                weekdayDiv.textContent = day;
                grid.appendChild(weekdayDiv);
            });
            
            // Êúà„ÅÆÊúÄÂàù„ÅÆÊó•„Å®ÊúÄÂæå„ÅÆÊó•„ÇíÂèñÂæó
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const prevLastDay = new Date(year, month, 0);
            
            // ÂâçÊúà„ÅÆÊó•‰ªò„ÇíÂüã„ÇÅ„Çã
            const firstDayOfWeek = firstDay.getDay();
            for (let i = firstDayOfWeek - 1; i >= 0; i--) {
                const day = prevLastDay.getDate() - i;
                const dayDiv = createCalendarDay(year, month - 1, day, true);
                grid.appendChild(dayDiv);
            }
            
            // ÂΩìÊúà„ÅÆÊó•‰ªò
            const today = new Date();
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayDiv = createCalendarDay(year, month, day, false);
                
                // ‰ªäÊó•„ÅÆÊó•‰ªò„Çí„Éè„Ç§„É©„Ç§„Éà
                if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate()) {
                    dayDiv.classList.add('today');
                }
                
                grid.appendChild(dayDiv);
            }
            
            // Ê¨°Êúà„ÅÆÊó•‰ªò„ÇíÂüã„ÇÅ„Çã
            const remainingDays = 42 - (firstDayOfWeek + lastDay.getDate());
            for (let day = 1; day <= remainingDays; day++) {
                const dayDiv = createCalendarDay(year, month + 1, day, true);
                grid.appendChild(dayDiv);
            }
        }

        // „Ç´„É¨„É≥„ÉÄ„Éº„ÅÆÊó•‰ªòË¶ÅÁ¥†„Çí‰ΩúÊàê
        function createCalendarDay(year, month, day, isOtherMonth) {
            const dayDiv = document.createElement('div');
            dayDiv.className = 'calendar-day';
            if (isOtherMonth) {
                dayDiv.classList.add('other-month');
            }
            
            const date = new Date(year, month, day);
            const dateStr = formatDateForKey(date);
            
            // „Åù„ÅÆÊó•„ÅÆÊ¥ªÂãï„Çí„ÉÅ„Çß„ÉÉ„ÇØ
            const dayLogs = app.logs.filter(log => {
                const logDate = new Date(log.date);
                return formatDateForKey(logDate) === dateStr;
            });
            
            const dayImprovements = app.improvements.filter(imp => {
                const impDate = new Date(imp.createdAt);
                return formatDateForKey(impDate) === dateStr;
            });
            
            if (dayLogs.length > 0 || dayImprovements.length > 0) {
                dayDiv.classList.add('has-activity');
            }
            
            // Êó•‰ªòÁï™Âè∑
            const numberDiv = document.createElement('div');
            numberDiv.className = 'calendar-day-number';
            numberDiv.textContent = day;
            dayDiv.appendChild(numberDiv);
            
            // „Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº
            if (dayLogs.length > 0 || dayImprovements.length > 0) {
                const indicatorDiv = document.createElement('div');
                indicatorDiv.className = 'calendar-day-indicator';
                
                // ÊúÄÂ§ß3„Å§„ÅÆ„Éâ„ÉÉ„Éà„ÇíË°®Á§∫
                const dotCount = Math.min(3, dayLogs.length + dayImprovements.length);
                for (let i = 0; i < dotCount; i++) {
                    const dot = document.createElement('div');
                    dot.className = 'activity-dot';
                    indicatorDiv.appendChild(dot);
                }
                
                dayDiv.appendChild(indicatorDiv);
            }
            
            // „ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà
            dayDiv.onclick = () => selectCalendarDate(date);
            
            return dayDiv;
        }

        // Êó•‰ªò„Çí„Ç≠„ÉºÁî®„ÅÆÊñáÂ≠óÂàó„Å´Â§âÊèõ
        function formatDateForKey(date) {
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        }

        // „Ç´„É¨„É≥„ÉÄ„Éº„ÅÆÊó•‰ªò„ÇíÈÅ∏Êäû
        function selectCalendarDate(date) {
            // ‰ª•Ââç„ÅÆÈÅ∏Êäû„ÇíËß£Èô§
            document.querySelectorAll('.calendar-day.selected').forEach(day => {
                day.classList.remove('selected');
            });
            
            // Êñ∞„Åó„ÅÑÈÅ∏Êäû„ÇíËøΩÂä†
            event.currentTarget.classList.add('selected');
            calendarState.selectedDate = date;
            
            // Ë©≥Á¥∞„ÇíË°®Á§∫
            showDayDetail(date);
        }

        // Êó•‰ªò„ÅÆË©≥Á¥∞„ÇíË°®Á§∫
        function showDayDetail(date) {
            const detailDiv = document.getElementById('dayDetail');
            const dateStr = formatDateForKey(date);
            
            // „Åù„ÅÆÊó•„ÅÆ„É≠„Ç∞„ÇíÂèñÂæó
            const dayLogs = app.logs.filter(log => {
                const logDate = new Date(log.date);
                return formatDateForKey(logDate) === dateStr;
            });
            
            // „Åù„ÅÆÊó•„ÅÆÊîπÂñÑÁÇπ„ÇíÂèñÂæó
            const dayImprovements = app.improvements.filter(imp => {
                const impDate = new Date(imp.createdAt);
                return formatDateForKey(impDate) === dateStr;
            });
            
            let html = `
                <div class="day-detail">
                    <div class="day-detail-header">
                        <div class="day-detail-date">${date.getFullYear()}Âπ¥${date.getMonth() + 1}Êúà${date.getDate()}Êó•</div>
                        <button class="btn btn-secondary" onclick="closeDayDetail()">Èñâ„Åò„Çã</button>
                    </div>
            `;
            
            // „É≠„Ç∞„Çª„ÇØ„Ç∑„Éß„É≥
            if (dayLogs.length > 0) {
                html += `
                    <div class="day-detail-section">
                        <div class="day-detail-section-title">
                            <span>üìù</span>
                            <span>Ê¥ªÂãïË®òÈå≤ (${dayLogs.length}‰ª∂)</span>
                        </div>
                `;
                
                dayLogs.forEach(log => {
                    const project = app.projects.find(p => p.id === log.projectId);
                    if (project) {
                        html += `
                            <div class="day-detail-item">
                                <div class="day-detail-project">${project.name}</div>
                        `;
                        
                        if (log.checkpoints) {
                            const checkedCount = log.checkpoints.filter(c => c).length;
                            html += `<div>„ÉÅ„Çß„ÉÉ„ÇØÈ†ÖÁõÆ: ${checkedCount}/${log.checkpoints.length} ÂÆå‰∫Ü</div>`;
                        }
                        
                        if (log.counts) {
                            log.counts.forEach((count, index) => {
                                if (count > 0 && project.countItems[index]) {
                                    html += `<div>${project.countItems[index]}: ${count}Âõû</div>`;
                                }
                            });
                        }
                        
                        if (log.milestones) {
                            const achievedCount = log.milestones.filter(m => m).length;
                            html += `<div>„Éû„Ç§„É´„Çπ„Éà„Éº„É≥: ${achievedCount}/${log.milestones.length} ÈÅîÊàê</div>`;
                        }
                        
                        html += `</div>`;
                    }
                });
                
                html += `</div>`;
            }
            
            // ÊîπÂñÑÁÇπ„Çª„ÇØ„Ç∑„Éß„É≥
            if (dayImprovements.length > 0) {
                html += `
                    <div class="day-detail-section">
                        <div class="day-detail-section-title">
                            <span>üí°</span>
                            <span>ÊîπÂñÑÁÇπ„ÉªÈÅ©Âøú (${dayImprovements.length}‰ª∂)</span>
                        </div>
                `;
                
                dayImprovements.forEach(imp => {
                    const project = app.projects.find(p => p.id === imp.projectId);
                    html += `
                        <div class="day-detail-item">
                            ${project ? `<div class="day-detail-project">${project.name}</div>` : ''}
                            <div>${imp.content}</div>
                        </div>
                    `;
                });
                
                html += `</div>`;
            }
            
            // AI„Ç≥„É°„É≥„Éà„Çª„ÇØ„Ç∑„Éß„É≥
            const dailyComment = JSON.parse(localStorage.getItem('pdca_daily_comments') || '[]')
                .find(comment => comment.date === dateStr);
            
            if (dailyComment) {
                html += `
                    <div class="day-detail-section">
                        <div class="day-detail-section-title">
                            <span>ü§ñ</span>
                            <span>AI„Ç≥„É°„É≥„Éà</span>
                        </div>
                        <div class="day-detail-item">
                            ${dailyComment.content}
                        </div>
                    </div>
                `;
            }
            
            if (dayLogs.length === 0 && dayImprovements.length === 0 && !dailyComment) {
                html += `
                    <div style="text-align: center; color: var(--gray); padding: 2rem;">
                        „Åì„ÅÆÊó•„ÅÆË®òÈå≤„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì
                    </div>
                `;
            }
            
            html += `</div>`;
            
            detailDiv.innerHTML = html;
            detailDiv.style.display = 'block';
            
            // „Çπ„ÇØ„É≠„Éº„É´‰ΩçÁΩÆ„ÇíË™øÊï¥
            detailDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Êó•‰ªòË©≥Á¥∞„ÇíÈñâ„Åò„Çã
        function closeDayDetail() {
            document.getElementById('dayDetail').style.display = 'none';
            document.querySelectorAll('.calendar-day.selected').forEach(day => {
                day.classList.remove('selected');
            });
        }

        // Êúà„ÇíÂ§âÊõ¥
        function changeMonth(delta) {
            calendarState.currentMonth += delta;
            
            if (calendarState.currentMonth < 0) {
                calendarState.currentMonth = 11;
                calendarState.currentYear--;
            } else if (calendarState.currentMonth > 11) {
                calendarState.currentMonth = 0;
                calendarState.currentYear++;
            }
            
            renderCalendar();
        }

        // ‰ªäÊó•„Å´ÁßªÂãï
        function goToToday() {
            const today = new Date();
            calendarState.currentYear = today.getFullYear();
            calendarState.currentMonth = today.getMonth();
            renderCalendar();
        }

        // Êó•‰ªò„Éï„Ç©„Éº„Éû„ÉÉ„Éà
        function formatDate(date, format = 'display') {
            if (format === 'file') {
                return date.toISOString().split('T')[0];
            }
            
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            
            return `${year}/${month}/${day}`;
        }
    </script>
</body>
</html>
